{"ast":null,"code":"import _objectSpread from\"C:/Users/MoritzSteinbach/Desktop/B\\xFCroplanner/officeplan/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{format,startOfWeek,addDays,isToday}from'date-fns';import{de}from'date-fns/locale';import{ChevronLeft,ChevronRight,User,X,Plus,Dog,Trash2,Lock}from'lucide-react';import{storage}from'../utils/storage';import{getDeviceId}from'../utils/identity';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AttendanceCalendar=_ref=>{let{selectedDate,onDateSelect}=_ref;const[employees,setEmployees]=useState([]);const[attendance,setAttendance]=useState([]);const[currentWeek,setCurrentWeek]=useState([]);const[newEmployeeName,setNewEmployeeName]=useState('');const[showPasswordModal,setShowPasswordModal]=useState(false);const[passwordModalType,setPasswordModalType]=useState('set');const[passwordInput,setPasswordInput]=useState('');const[pendingAction,setPendingAction]=useState(null);useEffect(()=>{console.log('AttendanceCalendar - Initialisierung');loadData();generateWeekDays();},[]);useEffect(()=>{generateWeekDays();},[selectedDate]);// Daten neu laden wenn sich Mitarbeiter oder Anwesenheitsdaten ändern\nuseEffect(()=>{const unsubscribe=storage.onDataChange(()=>{console.log('Datenänderung erkannt - lade Daten neu');loadData();});return unsubscribe;},[]);const loadData=async()=>{try{// Verwaiste Anwesenheitsdaten bereinigen\nawait storage.cleanOrphanedAttendanceData();const[allEmployees,allAttendance]=await Promise.all([storage.getEmployees(),storage.getAttendance()]);// Sortierung: Lokal hinzugefügte Mitarbeiter immer oben\nif(allEmployees.length>0){const localEmployeeIds=JSON.parse(localStorage.getItem('local_employees')||'[]');allEmployees.sort((a,b)=>{const aIsLocal=localEmployeeIds.includes(a.id);const bIsLocal=localEmployeeIds.includes(b.id);// Lokale Mitarbeiter kommen zuerst\nif(aIsLocal&&!bIsLocal)return-1;if(!aIsLocal&&bIsLocal)return 1;// Innerhalb der Gruppen nach ID sortieren\nconst idA=parseInt(a.id);const idB=parseInt(b.id);return idA-idB;});}setEmployees(allEmployees);setAttendance(allAttendance);}catch(error){console.error('Fehler beim Laden der Daten:',error);// Fallback zu leeren Arrays bei Fehlern\nsetEmployees([]);setAttendance([]);}};const generateWeekDays=()=>{const weekStart=startOfWeek(selectedDate,{weekStartsOn:1});const days=[];// Nur Montag bis Freitag (5 Tage)\nfor(let i=0;i<5;i++){days.push(addDays(weekStart,i));}setCurrentWeek(days);};const getStatusIcon=status=>{if(!status)return/*#__PURE__*/_jsx(X,{className:\"w-4 h-4 text-red-600\"});// default: Abwesend\nswitch(status){case'present':return/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 text-green-600\"});case'present_with_dog':return/*#__PURE__*/_jsx(Dog,{className:\"w-4 h-4 text-orange-600\"});case'absent':return/*#__PURE__*/_jsx(X,{className:\"w-4 h-4 text-red-600\"});default:return/*#__PURE__*/_jsx(X,{className:\"w-4 h-4 text-red-600\"});}};const getStatusColor=status=>{if(!status)return'bg-red-100 text-red-800 border-red-200';// default: Abwesend\nswitch(status){case'present':return'bg-green-100 text-green-800 border-green-200';case'present_with_dog':return'bg-orange-100 text-orange-800 border-orange-200';case'absent':return'bg-red-100 text-red-800 border-red-200';default:return'bg-red-100 text-red-800 border-red-200';}};const getStatusText=status=>{if(!status)return'Abwesend';switch(status){case'present':return'Anwesend';case'present_with_dog':return'Mit Hund';case'absent':return'Abwesend';default:return'Abwesend';}};const getAttendanceForEmployeeAndDate=(employeeId,date)=>{const dateStr=format(date,'yyyy-MM-dd');return attendance.find(entry=>entry.employeeId===employeeId&&entry.date===dateStr);};const getDogCountForDate=date=>{const dateStr=format(date,'yyyy-MM-dd');return attendance.filter(entry=>entry.date===dateStr&&entry.status==='present_with_dog').length;};const getActiveCountForDate=date=>{const dateStr=format(date,'yyyy-MM-dd');return attendance.filter(entry=>entry.date===dateStr&&(entry.status==='present'||entry.status==='present_with_dog')).length;};const canModifyEntry=entry=>{const deviceId=getDeviceId();if(!entry)return true;// Neue Einträge immer erlaubt\nif(!entry.ownerId)return true;// Alte Einträge ohne Owner\nif(entry.ownerId===deviceId)return true;// Eigenes Gerät\nreturn false;// Fremdes Gerät - Passwort nötig\n};const getStoredPassword=()=>{return localStorage.getItem('attendance_password');};const setStoredPassword=password=>{localStorage.setItem('attendance_password',password);};const handleCellClick=async(employeeId,date)=>{const existingEntry=getAttendanceForEmployeeAndDate(employeeId,date);// Prüfen ob Bearbeitung erlaubt ist\nif(existingEntry&&!canModifyEntry(existingEntry)){// Fremder Eintrag - Passwort erforderlich\nif(existingEntry.password){// Prüfen ob localStorage-Passwort passt\nconst storedPassword=getStoredPassword();if(storedPassword&&storedPassword===existingEntry.password){// Passwort stimmt - direkt bearbeiten\nawait performEntryUpdate(employeeId,date,existingEntry);return;}else{// Passwort stimmt nicht oder fehlt - Abfrage erforderlich\nsetPendingAction({employeeId,date,entry:existingEntry});setPasswordModalType('verify');setPasswordInput('');setShowPasswordModal(true);return;}}else{// Kein Passwort gesetzt - nicht bearbeitbar\nalert('Dieser Eintrag wurde von einem anderen Gerät erstellt und hat kein Passwort. Er kann nicht bearbeitet werden.');return;}}const dogCount=getDogCountForDate(date);const activeCount=getActiveCountForDate(date);const dateStr=format(date,'yyyy-MM-dd');console.log('DEBUG - Click:',{employeeId,date:dateStr,existingStatus:existingEntry===null||existingEntry===void 0?void 0:existingEntry.status,dogCount,allEntriesForDate:attendance.filter(entry=>entry.date===dateStr)});// Prüfen ob localStorage-Passwort vorhanden ist\nconst storedPassword=getStoredPassword();try{if(existingEntry){// Bestehenden Eintrag aktualisieren\n// Wenn kein Passwort im localStorage → Modal anzeigen\nif(!storedPassword){setPendingAction({employeeId,date,entry:existingEntry});setPasswordModalType('set');setPasswordInput('');setShowPasswordModal(true);return;}// Gewünschte Reihenfolge: absent -> present -> present_with_dog -> absent\nlet newStatus;if(existingEntry.status==='absent'){newStatus='present';}else if(existingEntry.status==='present'){// Nächster Schritt wäre \"mit Hund\", aber nur wenn Hundelimit nicht erreicht\nif(dogCount>=2){newStatus='absent';}else{newStatus='present_with_dog';}}else if(existingEntry.status==='present_with_dog'){newStatus='absent';}else{newStatus='present';}// Warnung ab der 26. aktiven Person (present/present_with_dog) am Tag\nconst wasActive=existingEntry.status==='present'||existingEntry.status==='present_with_dog';const willBeActive=newStatus==='present'||newStatus==='present_with_dog';const projectedActive=activeCount+(willBeActive&&!wasActive?1:0)-(!willBeActive&&wasActive?1:0);if(projectedActive>25&&willBeActive){alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');}const updatedEntry=_objectSpread(_objectSpread({},existingEntry),{},{status:newStatus,ownerId:getDeviceId(),password:storedPassword// Passwort aus localStorage\n});await storage.addAttendanceEntry(updatedEntry);}else{// Komplett neuen Eintrag erstellen\n// Wenn kein Passwort im localStorage → Modal anzeigen\nif(!storedPassword){setPendingAction({employeeId,date});setPasswordModalType('set');setPasswordInput('');setShowPasswordModal(true);return;}// Eintrag mit localStorage-Passwort erstellen\nconst newEntry={id:Date.now().toString(),employeeId:employeeId,date:dateStr,status:'present',ownerId:getDeviceId(),password:storedPassword};await storage.addAttendanceEntry(newEntry);}// Daten neu laden um sicherzustellen, dass alles synchron ist\nconst updatedAttendance=await storage.getAttendance();setAttendance(updatedAttendance);console.log('Status aktualisiert:',{employeeId,date:dateStr,newStatus:existingEntry?'updated':'created',totalAttendanceEntries:updatedAttendance.length,entriesForDate:updatedAttendance.filter(entry=>entry.date===dateStr).length});}catch(error){console.error('Fehler beim Aktualisieren der Anwesenheit:',error);alert('Fehler beim Speichern der Anwesenheit. Bitte versuchen Sie es erneut.');}};const handlePasswordSubmit=async()=>{if(!pendingAction)return;const{employeeId,date,entry}=pendingAction;const dateStr=format(date,'yyyy-MM-dd');if(passwordModalType==='verify'){// Passwort verifizieren\nif(!entry)return;if(!passwordInput.trim()){alert('Bitte gib ein Passwort ein!');return;}if(passwordInput!==entry.password){alert('Falsches Passwort!');return;}// Passwort korrekt - im localStorage speichern für zukünftige Verwendung\nsetStoredPassword(passwordInput);// Eintrag bearbeiten\nsetShowPasswordModal(false);setPendingAction(null);setPasswordInput('');// Jetzt den eigentlichen Click durchführen\nawait performEntryUpdate(employeeId,date,entry);}else{// Neues Passwort setzen (Pflichtfeld!)\nif(!passwordInput.trim()){alert('Bitte gib ein Passwort ein! Das Passwort wird benötigt, um deine Einträge von anderen Geräten aus bearbeiten zu können.');return;}// Passwort im localStorage speichern\nsetStoredPassword(passwordInput);const dogCount=getDogCountForDate(date);const activeCount=getActiveCountForDate(date);try{if(entry){// Bestehenden Eintrag aktualisieren (z.B. von absent zu present)\nlet newStatus='present';const wasActive=entry.status==='present'||entry.status==='present_with_dog';const willBeActive=true;// wird auf present gesetzt\nconst projectedActive=activeCount+(willBeActive&&!wasActive?1:0);if(projectedActive>25){alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');}const updatedEntry=_objectSpread(_objectSpread({},entry),{},{status:newStatus,ownerId:getDeviceId(),password:passwordInput});await storage.addAttendanceEntry(updatedEntry);}else{// Komplett neuen Eintrag erstellen\nif(activeCount+1>25){alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');}const newEntry={id:Date.now().toString(),employeeId:employeeId,date:dateStr,status:'present',ownerId:getDeviceId(),password:passwordInput};await storage.addAttendanceEntry(newEntry);}const updatedAttendance=await storage.getAttendance();setAttendance(updatedAttendance);setShowPasswordModal(false);setPendingAction(null);setPasswordInput('');}catch(error){console.error('Fehler beim Speichern der Anwesenheit:',error);alert('Fehler beim Speichern der Anwesenheit. Bitte versuchen Sie es erneut.');}}};const performEntryUpdate=async(employeeId,date,existingEntry)=>{const dateStr=format(date,'yyyy-MM-dd');const dogCount=getDogCountForDate(date);const activeCount=getActiveCountForDate(date);try{// Gewünschte Reihenfolge: absent -> present -> present_with_dog -> absent\nlet newStatus;if(existingEntry.status==='absent'){newStatus='present';}else if(existingEntry.status==='present'){// Nächster Schritt wäre \"mit Hund\", aber nur wenn Hundelimit nicht erreicht\nif(dogCount>=2){newStatus='absent';}else{newStatus='present_with_dog';}}else if(existingEntry.status==='present_with_dog'){newStatus='absent';}else{newStatus='present';}// Warnung ab der 26. aktiven Person (present/present_with_dog) am Tag\nconst wasActive=existingEntry.status==='present'||existingEntry.status==='present_with_dog';const willBeActive=newStatus==='present'||newStatus==='present_with_dog';const projectedActive=activeCount+(willBeActive&&!wasActive?1:0)-(!willBeActive&&wasActive?1:0);if(projectedActive>25&&willBeActive){alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');}const updatedEntry=_objectSpread(_objectSpread({},existingEntry),{},{status:newStatus});await storage.addAttendanceEntry(updatedEntry);// Daten neu laden um sicherzustellen, dass alles synchron ist\nconst updatedAttendance=await storage.getAttendance();setAttendance(updatedAttendance);}catch(error){console.error('Fehler beim Aktualisieren der Anwesenheit:',error);alert('Fehler beim Speichern der Anwesenheit. Bitte versuchen Sie es erneut.');}};const handleAddEmployee=async()=>{if(!newEmployeeName.trim())return;try{const newEmployee=await storage.addEmployee({name:newEmployeeName.trim(),department:'Unbekannt'// Standardwert\n});// Lokal hinzugefügte Mitarbeiter in localStorage speichern\nconst localEmployees=JSON.parse(localStorage.getItem('local_employees')||'[]');localEmployees.push(newEmployee.id);localStorage.setItem('local_employees',JSON.stringify(localEmployees));setNewEmployeeName('');await loadData();// Daten neu laden, um den neuen Mitarbeiter zu sehen\n}catch(error){console.error('Fehler beim Hinzufügen des Mitarbeiters:',error);alert('Fehler beim Hinzufügen des Mitarbeiters. Bitte versuchen Sie es erneut.');}};const handleDeleteEntry=async(employeeId,date,entry)=>{// Prüfen ob Bearbeitung erlaubt ist\nif(!canModifyEntry(entry)){// Fremder Eintrag - Passwort erforderlich\nif(entry.password){// Prüfen ob localStorage-Passwort passt\nconst storedPassword=getStoredPassword();if(!storedPassword||storedPassword!==entry.password){// Passwort-Abfrage erforderlich\nalert('Dieser Eintrag ist passwortgeschützt. Bitte bearbeite den Eintrag zuerst mit dem richtigen Passwort, um ihn löschen zu können.');return;}}else{alert('Dieser Eintrag wurde von einem anderen Gerät erstellt und hat kein Passwort. Er kann nicht gelöscht werden.');return;}}const employee=employees.find(emp=>emp.id===employeeId);const dateStr=format(date,'yyyy-MM-dd');if(window.confirm(\"Eintrag f\\xFCr \".concat(employee===null||employee===void 0?void 0:employee.name,\" am \").concat(format(date,'dd.MM.yyyy',{locale:de}),\" l\\xF6schen?\"))){try{await storage.deleteAttendanceEntry(employeeId,dateStr);const updatedAttendance=await storage.getAttendance();setAttendance(updatedAttendance);}catch(error){console.error('Fehler beim Löschen des Eintrags:',error);alert('Fehler beim Löschen des Eintrags. Bitte versuchen Sie es erneut.');}}};const handleDeleteEmployee=async employeeId=>{const employee=employees.find(emp=>emp.id===employeeId);if(!employee)return;const confirmMessage=\"Sind Sie sicher, dass Sie \\\"\".concat(employee.name,\"\\\" l\\xF6schen m\\xF6chten?\\n\\nDies l\\xF6scht auch alle Anwesenheitsdaten dieser Person.\");if(window.confirm(confirmMessage)){try{await storage.deleteEmployee(employeeId);setEmployees(employees.filter(emp=>emp.id!==employeeId));// Lokalen Mitarbeiter aus localStorage entfernen\nconst localEmployees=JSON.parse(localStorage.getItem('local_employees')||'[]');const updatedLocalEmployees=localEmployees.filter(id=>id!==employeeId);localStorage.setItem('local_employees',JSON.stringify(updatedLocalEmployees));// Anwesenheitsdaten lokal aktualisieren\nconst cleanedAttendance=attendance.filter(entry=>entry.employeeId!==employeeId);setAttendance(cleanedAttendance);console.log('Mitarbeiter erfolgreich gelöscht:',{employeeName:employee.name,employeeId,removedAttendanceEntries:attendance.length-cleanedAttendance.length});}catch(error){console.error('Fehler beim Löschen des Mitarbeiters:',error);alert('Fehler beim Löschen des Mitarbeiters. Bitte versuchen Sie es erneut.');}}};const handlePreviousWeek=()=>{const newDate=addDays(selectedDate,-7);onDateSelect(newDate);};const handleNextWeek=()=>{const newDate=addDays(selectedDate,7);onDateSelect(newDate);};const isCurrentWeek=()=>{const currentWeekStart=startOfWeek(new Date(),{weekStartsOn:1});const selectedWeekStart=startOfWeek(selectedDate,{weekStartsOn:1});return currentWeekStart.getTime()===selectedWeekStart.getTime();};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[!isCurrentWeek()&&/*#__PURE__*/_jsx(\"button\",{onClick:handlePreviousWeek,className:\"p-2 hover:bg-gray-100 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900\",children:currentWeek.length>0?\"\".concat(format(currentWeek[0],'dd.MM.yyyy',{locale:de}),\" - \").concat(format(currentWeek[4],'dd.MM.yyyy',{locale:de})):'Lade Kalender...'}),currentWeek.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center mt-2 space-x-4 text-sm text-gray-600\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(User,{className:\"w-4 h-4 mr-1\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"\".concat(getActiveCountForDate(selectedDate)>=25?'text-red-600 font-medium':''),children:[getActiveCountForDate(selectedDate),\"/25 belegt (f\\xFCr \",format(selectedDate,'dd.MM.yyyy',{locale:de}),\")\"]})]})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleNextWeek,className:\"p-2 hover:bg-gray-100 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(ChevronRight,{className:\"w-5 h-5\"})})]})}),currentWeek.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500 uppercase tracking-wider\",children:\"Mitarbeiter\"}),currentWeek.map(date=>/*#__PURE__*/_jsx(\"th\",{className:\"px-2 py-3 text-center text-sm font-medium text-gray-500 uppercase tracking-wider\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400\",children:format(date,'EEE',{locale:de})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium \".concat(isToday(date)?'text-blue-600 bg-blue-100 rounded-full w-8 h-8 flex items-center justify-center':''),children:format(date,'dd')}),/*#__PURE__*/_jsxs(\"span\",{className:\"mt-1 text-[11px] \".concat(getActiveCountForDate(date)>=25?'text-red-600 font-medium':'text-gray-500'),children:[getActiveCountForDate(date),\"/25\"]})]})},date.toISOString()))]})}),/*#__PURE__*/_jsxs(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:[employees.map(employee=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 group\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 h-8 w-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-blue-700\",children:employee.name.split(' ').map(n=>n[0]).join('')})})}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-900\",children:employee.name})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleDeleteEmployee(employee.id);},className:\"p-1 hover:bg-red-100 rounded-full text-red-600 transition-colors disabled:opacity-40\",title:\"Mitarbeiter l\\xF6schen\",disabled:!// Nur lokale Mitarbeiter (aus eigener Liste) dürfen gelöscht werden\nJSON.parse(localStorage.getItem('local_employees')||'[]').includes(employee.id),children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})}),currentWeek.map(date=>{var _entry$status;const entry=getAttendanceForEmployeeAndDate(employee.id,date);const dogCount=getDogCountForDate(date);const displayStatus=(_entry$status=entry===null||entry===void 0?void 0:entry.status)!==null&&_entry$status!==void 0?_entry$status:'absent';// Lock-Symbol nur anzeigen wenn Passwort nötig UND nicht im localStorage vorhanden/passend\nconst storedPassword=getStoredPassword();const isProtected=entry&&entry.password&&!canModifyEntry(entry)&&(!storedPassword||storedPassword!==entry.password);return/*#__PURE__*/_jsx(\"td\",{className:\"px-2 py-3 text-center relative\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border \".concat(getStatusColor(displayStatus),\" cursor-pointer hover:opacity-80 transition-opacity\"),onClick:()=>handleCellClick(employee.id,date),children:[getStatusIcon(displayStatus),/*#__PURE__*/_jsx(\"span\",{className:\"ml-1\",children:getStatusText(displayStatus)}),isProtected&&/*#__PURE__*/_jsx(\"span\",{title:\"Passwortgesch\\xFCtzt\",children:/*#__PURE__*/_jsx(Lock,{className:\"w-3 h-3 ml-1 opacity-50\"})})]}),entry&&entry.status!=='absent'&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleDeleteEntry(employee.id,date,entry);},className:\"p-1 hover:bg-red-100 rounded-full text-red-600 transition-colors opacity-0 group-hover:opacity-100\",title:\"Eintrag l\\xF6schen\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-3 h-3\"})})]})},date.toISOString());})]},employee.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-50 hover:bg-gray-100\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 h-8 w-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4 text-green-600\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 min-w-0\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Vollst\\xE4ndiger Name...\",value:newEmployeeName,onChange:e=>setNewEmployeeName(e.target.value),className:\"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\",onKeyPress:e=>e.key==='Enter'&&handleAddEmployee()})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 flex items-center mt-6\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleAddEmployee,disabled:!newEmployeeName.trim(),className:\"px-4 py-1.5 text-sm font-medium bg-green-700 text-white rounded-md hover:bg-green-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap\",children:\"Hinzuf\\xFCgen\"})})]})}),currentWeek.map(date=>/*#__PURE__*/_jsx(\"td\",{className:\"px-2 py-4 text-center\"},date.toISOString()))]})]})]})})}),showPasswordModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:passwordModalType==='set'?'Passwort festlegen':'Passwort eingeben'}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[passwordModalType==='set'&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Bitte lege ein Passwort fest. Dieses Passwort wird auf diesem Ger\\xE4t gespeichert und erm\\xF6glicht es dir, deine Eintr\\xE4ge auch von anderen Ger\\xE4ten aus zu bearbeiten. Du brauchst es nur einmal pro Ger\\xE4t einzugeben.\"}),passwordModalType==='verify'&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Dieser Eintrag wurde von einem anderen Ger\\xE4t erstellt. Bitte gib das Passwort ein, um ihn zu bearbeiten.\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Passwort\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:passwordInput,onChange:e=>setPasswordInput(e.target.value),className:\"input-field\",placeholder:\"Passwort eingeben\",onKeyPress:e=>{if(e.key==='Enter'){handlePasswordSubmit();}},autoFocus:true,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowPasswordModal(false);setPendingAction(null);setPasswordInput('');},className:\"btn-secondary\",children:\"Abbrechen\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handlePasswordSubmit,className:\"btn-primary\",children:passwordModalType==='set'?'Erstellen':'Bestätigen'})]})]})]})})})]});};export default AttendanceCalendar;","map":{"version":3,"names":["React","useState","useEffect","format","startOfWeek","addDays","isToday","de","ChevronLeft","ChevronRight","User","X","Plus","Dog","Trash2","Lock","storage","getDeviceId","jsx","_jsx","jsxs","_jsxs","AttendanceCalendar","_ref","selectedDate","onDateSelect","employees","setEmployees","attendance","setAttendance","currentWeek","setCurrentWeek","newEmployeeName","setNewEmployeeName","showPasswordModal","setShowPasswordModal","passwordModalType","setPasswordModalType","passwordInput","setPasswordInput","pendingAction","setPendingAction","console","log","loadData","generateWeekDays","unsubscribe","onDataChange","cleanOrphanedAttendanceData","allEmployees","allAttendance","Promise","all","getEmployees","getAttendance","length","localEmployeeIds","JSON","parse","localStorage","getItem","sort","a","b","aIsLocal","includes","id","bIsLocal","idA","parseInt","idB","error","weekStart","weekStartsOn","days","i","push","getStatusIcon","status","className","getStatusColor","getStatusText","getAttendanceForEmployeeAndDate","employeeId","date","dateStr","find","entry","getDogCountForDate","filter","getActiveCountForDate","canModifyEntry","deviceId","ownerId","getStoredPassword","setStoredPassword","password","setItem","handleCellClick","existingEntry","storedPassword","performEntryUpdate","alert","dogCount","activeCount","existingStatus","allEntriesForDate","newStatus","wasActive","willBeActive","projectedActive","updatedEntry","_objectSpread","addAttendanceEntry","newEntry","Date","now","toString","updatedAttendance","totalAttendanceEntries","entriesForDate","handlePasswordSubmit","trim","handleAddEmployee","newEmployee","addEmployee","name","department","localEmployees","stringify","handleDeleteEntry","employee","emp","window","confirm","concat","locale","deleteAttendanceEntry","handleDeleteEmployee","confirmMessage","deleteEmployee","updatedLocalEmployees","cleanedAttendance","employeeName","removedAttendanceEntries","handlePreviousWeek","newDate","handleNextWeek","isCurrentWeek","currentWeekStart","selectedWeekStart","getTime","children","onClick","map","toISOString","split","n","join","e","stopPropagation","title","disabled","_entry$status","displayStatus","isProtected","type","placeholder","value","onChange","target","onKeyPress","key","autoFocus","required"],"sources":["C:/Users/MoritzSteinbach/Desktop/Büroplanner/officeplan/src/components/AttendanceCalendar.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { format, startOfWeek, addDays, isToday } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { ChevronLeft, ChevronRight, User, X, Plus, Dog, Trash2, Lock } from 'lucide-react';\nimport { Employee, AttendanceEntry, AttendanceStatus } from '../types';\nimport { storage } from '../utils/storage';\nimport { getDeviceId } from '../utils/identity';\n\ninterface AttendanceCalendarProps {\n  selectedDate: Date;\n  onDateSelect: (date: Date) => void;\n}\n\nconst AttendanceCalendar: React.FC<AttendanceCalendarProps> = ({ selectedDate, onDateSelect }) => {\n  const [employees, setEmployees] = useState<Employee[]>([]);\n  const [attendance, setAttendance] = useState<AttendanceEntry[]>([]);\n  const [currentWeek, setCurrentWeek] = useState<Date[]>([]);\n  const [newEmployeeName, setNewEmployeeName] = useState('');\n  const [showPasswordModal, setShowPasswordModal] = useState(false);\n  const [passwordModalType, setPasswordModalType] = useState<'set' | 'verify'>('set');\n  const [passwordInput, setPasswordInput] = useState('');\n  const [pendingAction, setPendingAction] = useState<{employeeId: string, date: Date, entry?: AttendanceEntry} | null>(null);\n\n  useEffect(() => {\n    console.log('AttendanceCalendar - Initialisierung');\n    \n    loadData();\n    generateWeekDays();\n  }, []);\n\n  useEffect(() => {\n    generateWeekDays();\n  }, [selectedDate]);\n\n  // Daten neu laden wenn sich Mitarbeiter oder Anwesenheitsdaten ändern\n  useEffect(() => {\n    const unsubscribe = storage.onDataChange(() => {\n      console.log('Datenänderung erkannt - lade Daten neu');\n      loadData();\n    });\n\n    return unsubscribe;\n  }, []);\n\n  const loadData = async () => {\n    try {\n      // Verwaiste Anwesenheitsdaten bereinigen\n      await storage.cleanOrphanedAttendanceData();\n      \n      const [allEmployees, allAttendance] = await Promise.all([\n        storage.getEmployees(),\n        storage.getAttendance()\n      ]);\n      \n      // Sortierung: Lokal hinzugefügte Mitarbeiter immer oben\n      if (allEmployees.length > 0) {\n        const localEmployeeIds = JSON.parse(localStorage.getItem('local_employees') || '[]');\n        \n        allEmployees.sort((a, b) => {\n          const aIsLocal = localEmployeeIds.includes(a.id);\n          const bIsLocal = localEmployeeIds.includes(b.id);\n          \n          // Lokale Mitarbeiter kommen zuerst\n          if (aIsLocal && !bIsLocal) return -1;\n          if (!aIsLocal && bIsLocal) return 1;\n          \n          // Innerhalb der Gruppen nach ID sortieren\n          const idA = parseInt(a.id);\n          const idB = parseInt(b.id);\n          return idA - idB;\n        });\n      }\n      \n      setEmployees(allEmployees);\n      setAttendance(allAttendance);\n    } catch (error) {\n      console.error('Fehler beim Laden der Daten:', error);\n      // Fallback zu leeren Arrays bei Fehlern\n      setEmployees([]);\n      setAttendance([]);\n    }\n  };\n\n  const generateWeekDays = () => {\n    const weekStart = startOfWeek(selectedDate, { weekStartsOn: 1 });\n    const days: Date[] = [];\n    // Nur Montag bis Freitag (5 Tage)\n    for (let i = 0; i < 5; i++) {\n      days.push(addDays(weekStart, i));\n    }\n    setCurrentWeek(days);\n  };\n\n  const getStatusIcon = (status: AttendanceStatus | null) => {\n    if (!status) return <X className=\"w-4 h-4 text-red-600\" />; // default: Abwesend\n    \n    switch (status) {\n      case 'present':\n        return <User className=\"w-4 h-4 text-green-600\" />;\n      case 'present_with_dog':\n        return <Dog className=\"w-4 h-4 text-orange-600\" />;\n      case 'absent':\n        return <X className=\"w-4 h-4 text-red-600\" />;\n      default:\n        return <X className=\"w-4 h-4 text-red-600\" />;\n    }\n  };\n\n  const getStatusColor = (status: AttendanceStatus | null) => {\n    if (!status) return 'bg-red-100 text-red-800 border-red-200'; // default: Abwesend\n    \n    switch (status) {\n      case 'present':\n        return 'bg-green-100 text-green-800 border-green-200';\n      case 'present_with_dog':\n        return 'bg-orange-100 text-orange-800 border-orange-200';\n      case 'absent':\n        return 'bg-red-100 text-red-800 border-red-200';\n      default:\n        return 'bg-red-100 text-red-800 border-red-200';\n    }\n  };\n\n  const getStatusText = (status: AttendanceStatus | null) => {\n    if (!status) return 'Abwesend';\n    \n    switch (status) {\n      case 'present':\n        return 'Anwesend';\n      case 'present_with_dog':\n        return 'Mit Hund';\n      case 'absent':\n        return 'Abwesend';\n      default:\n        return 'Abwesend';\n    }\n  };\n\n  const getAttendanceForEmployeeAndDate = (employeeId: string, date: Date) => {\n    const dateStr = format(date, 'yyyy-MM-dd');\n    return attendance.find(entry => \n      entry.employeeId === employeeId && entry.date === dateStr\n    );\n  };\n\n  const getDogCountForDate = (date: Date) => {\n    const dateStr = format(date, 'yyyy-MM-dd');\n    return attendance.filter(entry => \n      entry.date === dateStr && entry.status === 'present_with_dog'\n    ).length;\n  };\n\n  const getActiveCountForDate = (date: Date) => {\n    const dateStr = format(date, 'yyyy-MM-dd');\n    return attendance.filter(entry => \n      entry.date === dateStr && (entry.status === 'present' || entry.status === 'present_with_dog')\n    ).length;\n  };\n\n  const canModifyEntry = (entry?: AttendanceEntry | null): boolean => {\n    const deviceId = getDeviceId();\n    if (!entry) return true; // Neue Einträge immer erlaubt\n    if (!entry.ownerId) return true; // Alte Einträge ohne Owner\n    if (entry.ownerId === deviceId) return true; // Eigenes Gerät\n    return false; // Fremdes Gerät - Passwort nötig\n  };\n\n  const getStoredPassword = (): string | null => {\n    return localStorage.getItem('attendance_password');\n  };\n\n  const setStoredPassword = (password: string): void => {\n    localStorage.setItem('attendance_password', password);\n  };\n\n  const handleCellClick = async (employeeId: string, date: Date) => {\n    const existingEntry = getAttendanceForEmployeeAndDate(employeeId, date);\n    \n    // Prüfen ob Bearbeitung erlaubt ist\n    if (existingEntry && !canModifyEntry(existingEntry)) {\n      // Fremder Eintrag - Passwort erforderlich\n      if (existingEntry.password) {\n        // Prüfen ob localStorage-Passwort passt\n        const storedPassword = getStoredPassword();\n        if (storedPassword && storedPassword === existingEntry.password) {\n          // Passwort stimmt - direkt bearbeiten\n          await performEntryUpdate(employeeId, date, existingEntry);\n          return;\n        } else {\n          // Passwort stimmt nicht oder fehlt - Abfrage erforderlich\n          setPendingAction({ employeeId, date, entry: existingEntry });\n          setPasswordModalType('verify');\n          setPasswordInput('');\n          setShowPasswordModal(true);\n          return;\n        }\n      } else {\n        // Kein Passwort gesetzt - nicht bearbeitbar\n        alert('Dieser Eintrag wurde von einem anderen Gerät erstellt und hat kein Passwort. Er kann nicht bearbeitet werden.');\n        return;\n      }\n    }\n    \n    const dogCount = getDogCountForDate(date);\n    const activeCount = getActiveCountForDate(date);\n    const dateStr = format(date, 'yyyy-MM-dd');\n    \n    console.log('DEBUG - Click:', {\n      employeeId,\n      date: dateStr,\n      existingStatus: existingEntry?.status,\n      dogCount,\n      allEntriesForDate: attendance.filter(entry => entry.date === dateStr)\n    });\n    \n    // Prüfen ob localStorage-Passwort vorhanden ist\n    const storedPassword = getStoredPassword();\n    \n    try {\n      if (existingEntry) {\n        // Bestehenden Eintrag aktualisieren\n        // Wenn kein Passwort im localStorage → Modal anzeigen\n        if (!storedPassword) {\n          setPendingAction({ employeeId, date, entry: existingEntry });\n          setPasswordModalType('set');\n          setPasswordInput('');\n          setShowPasswordModal(true);\n          return;\n        }\n        \n        // Gewünschte Reihenfolge: absent -> present -> present_with_dog -> absent\n        let newStatus: AttendanceStatus;\n\n        if (existingEntry.status === 'absent') {\n          newStatus = 'present';\n        } else if (existingEntry.status === 'present') {\n          // Nächster Schritt wäre \"mit Hund\", aber nur wenn Hundelimit nicht erreicht\n          if (dogCount >= 2) {\n            newStatus = 'absent';\n          } else {\n            newStatus = 'present_with_dog';\n          }\n        } else if (existingEntry.status === 'present_with_dog') {\n          newStatus = 'absent';\n        } else {\n          newStatus = 'present';\n        }\n        \n        // Warnung ab der 26. aktiven Person (present/present_with_dog) am Tag\n        const wasActive = existingEntry.status === 'present' || existingEntry.status === 'present_with_dog';\n        const willBeActive = newStatus === 'present' || newStatus === 'present_with_dog';\n        const projectedActive = activeCount + (willBeActive && !wasActive ? 1 : 0) - (!willBeActive && wasActive ? 1 : 0);\n        if (projectedActive > 25 && willBeActive) {\n          alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');\n        }\n\n        const updatedEntry: AttendanceEntry = {\n          ...existingEntry,\n          status: newStatus,\n          ownerId: getDeviceId(),\n          password: storedPassword, // Passwort aus localStorage\n        };\n        \n        await storage.addAttendanceEntry(updatedEntry);\n      } else {\n        // Komplett neuen Eintrag erstellen\n        // Wenn kein Passwort im localStorage → Modal anzeigen\n        if (!storedPassword) {\n          setPendingAction({ employeeId, date });\n          setPasswordModalType('set');\n          setPasswordInput('');\n          setShowPasswordModal(true);\n          return;\n        }\n        \n        // Eintrag mit localStorage-Passwort erstellen\n        const newEntry: AttendanceEntry = {\n          id: Date.now().toString(),\n          employeeId: employeeId,\n          date: dateStr,\n          status: 'present',\n          ownerId: getDeviceId(),\n          password: storedPassword,\n        };\n        \n        await storage.addAttendanceEntry(newEntry);\n      }\n      \n      // Daten neu laden um sicherzustellen, dass alles synchron ist\n      const updatedAttendance = await storage.getAttendance();\n      setAttendance(updatedAttendance);\n      \n      console.log('Status aktualisiert:', {\n        employeeId,\n        date: dateStr,\n        newStatus: existingEntry ? 'updated' : 'created',\n        totalAttendanceEntries: updatedAttendance.length,\n        entriesForDate: updatedAttendance.filter(entry => entry.date === dateStr).length\n      });\n    } catch (error) {\n      console.error('Fehler beim Aktualisieren der Anwesenheit:', error);\n      alert('Fehler beim Speichern der Anwesenheit. Bitte versuchen Sie es erneut.');\n    }\n  };\n\n  const handlePasswordSubmit = async () => {\n    if (!pendingAction) return;\n\n    const { employeeId, date, entry } = pendingAction;\n    const dateStr = format(date, 'yyyy-MM-dd');\n\n    if (passwordModalType === 'verify') {\n      // Passwort verifizieren\n      if (!entry) return;\n      \n      if (!passwordInput.trim()) {\n        alert('Bitte gib ein Passwort ein!');\n        return;\n      }\n      \n      if (passwordInput !== entry.password) {\n        alert('Falsches Passwort!');\n        return;\n      }\n      \n      // Passwort korrekt - im localStorage speichern für zukünftige Verwendung\n      setStoredPassword(passwordInput);\n      \n      // Eintrag bearbeiten\n      setShowPasswordModal(false);\n      setPendingAction(null);\n      setPasswordInput('');\n      \n      // Jetzt den eigentlichen Click durchführen\n      await performEntryUpdate(employeeId, date, entry);\n    } else {\n      // Neues Passwort setzen (Pflichtfeld!)\n      if (!passwordInput.trim()) {\n        alert('Bitte gib ein Passwort ein! Das Passwort wird benötigt, um deine Einträge von anderen Geräten aus bearbeiten zu können.');\n        return;\n      }\n      \n      // Passwort im localStorage speichern\n      setStoredPassword(passwordInput);\n      \n      const dogCount = getDogCountForDate(date);\n      const activeCount = getActiveCountForDate(date);\n      \n      try {\n        if (entry) {\n          // Bestehenden Eintrag aktualisieren (z.B. von absent zu present)\n          let newStatus: AttendanceStatus = 'present';\n          \n          const wasActive = entry.status === 'present' || entry.status === 'present_with_dog';\n          const willBeActive = true; // wird auf present gesetzt\n          const projectedActive = activeCount + (willBeActive && !wasActive ? 1 : 0);\n          \n          if (projectedActive > 25) {\n            alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');\n          }\n          \n          const updatedEntry: AttendanceEntry = {\n            ...entry,\n            status: newStatus,\n            ownerId: getDeviceId(),\n            password: passwordInput,\n          };\n          \n          await storage.addAttendanceEntry(updatedEntry);\n        } else {\n          // Komplett neuen Eintrag erstellen\n          if (activeCount + 1 > 25) {\n            alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');\n          }\n\n          const newEntry: AttendanceEntry = {\n            id: Date.now().toString(),\n            employeeId: employeeId,\n            date: dateStr,\n            status: 'present',\n            ownerId: getDeviceId(),\n            password: passwordInput,\n          };\n          \n          await storage.addAttendanceEntry(newEntry);\n        }\n        \n        const updatedAttendance = await storage.getAttendance();\n        setAttendance(updatedAttendance);\n        \n        setShowPasswordModal(false);\n        setPendingAction(null);\n        setPasswordInput('');\n      } catch (error) {\n        console.error('Fehler beim Speichern der Anwesenheit:', error);\n        alert('Fehler beim Speichern der Anwesenheit. Bitte versuchen Sie es erneut.');\n      }\n    }\n  };\n\n  const performEntryUpdate = async (employeeId: string, date: Date, existingEntry: AttendanceEntry) => {\n    const dateStr = format(date, 'yyyy-MM-dd');\n    const dogCount = getDogCountForDate(date);\n    const activeCount = getActiveCountForDate(date);\n\n    try {\n      // Gewünschte Reihenfolge: absent -> present -> present_with_dog -> absent\n      let newStatus: AttendanceStatus;\n\n      if (existingEntry.status === 'absent') {\n        newStatus = 'present';\n      } else if (existingEntry.status === 'present') {\n        // Nächster Schritt wäre \"mit Hund\", aber nur wenn Hundelimit nicht erreicht\n        if (dogCount >= 2) {\n          newStatus = 'absent';\n        } else {\n          newStatus = 'present_with_dog';\n        }\n      } else if (existingEntry.status === 'present_with_dog') {\n        newStatus = 'absent';\n      } else {\n        newStatus = 'present';\n      }\n      \n      // Warnung ab der 26. aktiven Person (present/present_with_dog) am Tag\n      const wasActive = existingEntry.status === 'present' || existingEntry.status === 'present_with_dog';\n      const willBeActive = newStatus === 'present' || newStatus === 'present_with_dog';\n      const projectedActive = activeCount + (willBeActive && !wasActive ? 1 : 0) - (!willBeActive && wasActive ? 1 : 0);\n      if (projectedActive > 25 && willBeActive) {\n        alert('Hinweis: Das Büro ist bereits voll (max. 25 Personen). Du kannst dich trotzdem eintragen.');\n      }\n\n      const updatedEntry: AttendanceEntry = {\n        ...existingEntry,\n        status: newStatus,\n      };\n      \n      await storage.addAttendanceEntry(updatedEntry);\n      \n      // Daten neu laden um sicherzustellen, dass alles synchron ist\n      const updatedAttendance = await storage.getAttendance();\n      setAttendance(updatedAttendance);\n    } catch (error) {\n      console.error('Fehler beim Aktualisieren der Anwesenheit:', error);\n      alert('Fehler beim Speichern der Anwesenheit. Bitte versuchen Sie es erneut.');\n    }\n  };\n\n  const handleAddEmployee = async () => {\n    if (!newEmployeeName.trim()) return;\n\n    try {\n      const newEmployee = await storage.addEmployee({\n        name: newEmployeeName.trim(),\n        department: 'Unbekannt', // Standardwert\n      });\n      \n      // Lokal hinzugefügte Mitarbeiter in localStorage speichern\n      const localEmployees = JSON.parse(localStorage.getItem('local_employees') || '[]');\n      localEmployees.push(newEmployee.id);\n      localStorage.setItem('local_employees', JSON.stringify(localEmployees));\n      \n      setNewEmployeeName('');\n      await loadData(); // Daten neu laden, um den neuen Mitarbeiter zu sehen\n    } catch (error) {\n      console.error('Fehler beim Hinzufügen des Mitarbeiters:', error);\n      alert('Fehler beim Hinzufügen des Mitarbeiters. Bitte versuchen Sie es erneut.');\n    }\n  };\n\n  const handleDeleteEntry = async (employeeId: string, date: Date, entry: AttendanceEntry) => {\n    // Prüfen ob Bearbeitung erlaubt ist\n    if (!canModifyEntry(entry)) {\n      // Fremder Eintrag - Passwort erforderlich\n      if (entry.password) {\n        // Prüfen ob localStorage-Passwort passt\n        const storedPassword = getStoredPassword();\n        if (!storedPassword || storedPassword !== entry.password) {\n          // Passwort-Abfrage erforderlich\n          alert('Dieser Eintrag ist passwortgeschützt. Bitte bearbeite den Eintrag zuerst mit dem richtigen Passwort, um ihn löschen zu können.');\n          return;\n        }\n      } else {\n        alert('Dieser Eintrag wurde von einem anderen Gerät erstellt und hat kein Passwort. Er kann nicht gelöscht werden.');\n        return;\n      }\n    }\n\n    const employee = employees.find(emp => emp.id === employeeId);\n    const dateStr = format(date, 'yyyy-MM-dd');\n    \n    if (window.confirm(`Eintrag für ${employee?.name} am ${format(date, 'dd.MM.yyyy', { locale: de })} löschen?`)) {\n      try {\n        await storage.deleteAttendanceEntry(employeeId, dateStr);\n        const updatedAttendance = await storage.getAttendance();\n        setAttendance(updatedAttendance);\n      } catch (error) {\n        console.error('Fehler beim Löschen des Eintrags:', error);\n        alert('Fehler beim Löschen des Eintrags. Bitte versuchen Sie es erneut.');\n      }\n    }\n  };\n\n  const handleDeleteEmployee = async (employeeId: string) => {\n    const employee = employees.find(emp => emp.id === employeeId);\n    if (!employee) return;\n    \n    const confirmMessage = `Sind Sie sicher, dass Sie \"${employee.name}\" löschen möchten?\\n\\nDies löscht auch alle Anwesenheitsdaten dieser Person.`;\n    \n    if (window.confirm(confirmMessage)) {\n      try {\n        await storage.deleteEmployee(employeeId);\n        setEmployees(employees.filter(emp => emp.id !== employeeId));\n        \n        // Lokalen Mitarbeiter aus localStorage entfernen\n        const localEmployees = JSON.parse(localStorage.getItem('local_employees') || '[]');\n        const updatedLocalEmployees = localEmployees.filter((id: string) => id !== employeeId);\n        localStorage.setItem('local_employees', JSON.stringify(updatedLocalEmployees));\n        \n        // Anwesenheitsdaten lokal aktualisieren\n        const cleanedAttendance = attendance.filter(entry => entry.employeeId !== employeeId);\n        setAttendance(cleanedAttendance);\n        \n        console.log('Mitarbeiter erfolgreich gelöscht:', {\n          employeeName: employee.name,\n          employeeId,\n          removedAttendanceEntries: attendance.length - cleanedAttendance.length\n        });\n      } catch (error) {\n        console.error('Fehler beim Löschen des Mitarbeiters:', error);\n        alert('Fehler beim Löschen des Mitarbeiters. Bitte versuchen Sie es erneut.');\n      }\n    }\n  };\n\n  const handlePreviousWeek = () => {\n    const newDate = addDays(selectedDate, -7);\n    onDateSelect(newDate);\n  };\n\n  const handleNextWeek = () => {\n    const newDate = addDays(selectedDate, 7);\n    onDateSelect(newDate);\n  };\n\n  const isCurrentWeek = () => {\n    const currentWeekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\n    const selectedWeekStart = startOfWeek(selectedDate, { weekStartsOn: 1 });\n    return currentWeekStart.getTime() === selectedWeekStart.getTime();\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Kalender-Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          {!isCurrentWeek() && (\n            <button\n              onClick={handlePreviousWeek}\n              className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            >\n              <ChevronLeft className=\"w-5 h-5\" />\n            </button>\n          )}\n          \n          <div className=\"text-center\">\n            <h2 className=\"text-xl font-semibold text-gray-900\">\n              {currentWeek.length > 0 ? (\n                `${format(currentWeek[0], 'dd.MM.yyyy', { locale: de })} - ${format(currentWeek[4], 'dd.MM.yyyy', { locale: de })}`\n              ) : (\n                'Lade Kalender...'\n              )}\n            </h2>\n            {currentWeek.length > 0 && (\n              <div className=\"flex items-center justify-center mt-2 space-x-4 text-sm text-gray-600\">\n                <div className=\"flex items-center\">\n                  <User className=\"w-4 h-4 mr-1\" />\n                  <span className={`${getActiveCountForDate(selectedDate) >= 25 ? 'text-red-600 font-medium' : ''}`}>\n                    {getActiveCountForDate(selectedDate)}/25 belegt (für {format(selectedDate, 'dd.MM.yyyy', { locale: de })})\n                  </span>\n                </div>\n              </div>\n            )}\n          </div>\n          \n          <button\n            onClick={handleNextWeek}\n            className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n          >\n            <ChevronRight className=\"w-5 h-5\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Kalender-Tabelle */}\n      {currentWeek.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500 uppercase tracking-wider\">\n                    Mitarbeiter\n                  </th>\n                  {currentWeek.map((date) => (\n                    <th key={date.toISOString()} className=\"px-2 py-3 text-center text-sm font-medium text-gray-500 uppercase tracking-wider\">\n                      <div className=\"flex flex-col items-center\">\n                        <span className=\"text-xs text-gray-400\">\n                          {format(date, 'EEE', { locale: de })}\n                        </span>\n                        <span className={`text-sm font-medium ${\n                          isToday(date) ? 'text-blue-600 bg-blue-100 rounded-full w-8 h-8 flex items-center justify-center' : ''\n                        }`}>\n                          {format(date, 'dd')}\n                        </span>\n                        <span className={`mt-1 text-[11px] ${getActiveCountForDate(date) >= 25 ? 'text-red-600 font-medium' : 'text-gray-500'}`}>\n                          {getActiveCountForDate(date)}/25\n                        </span>\n                      </div>\n                    </th>\n                  ))}\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {employees.map((employee) => (\n                  <tr key={employee.id} className=\"hover:bg-gray-50 group\">\n                    <td className=\"px-4 py-3 whitespace-nowrap\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center\">\n                          <div className=\"flex-shrink-0 h-8 w-8\">\n                            <div className=\"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center\">\n                              <span className=\"text-sm font-medium text-blue-700\">\n                                {employee.name.split(' ').map(n => n[0]).join('')}\n                              </span>\n                            </div>\n                          </div>\n                          <div className=\"ml-3\">\n                            <div className=\"text-sm font-medium text-gray-900\">\n                              {employee.name}\n                            </div>\n                          </div>\n                        </div>\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleDeleteEmployee(employee.id);\n                          }}\n                          className=\"p-1 hover:bg-red-100 rounded-full text-red-600 transition-colors disabled:opacity-40\"\n                          title=\"Mitarbeiter löschen\"\n                          disabled={!\n                            // Nur lokale Mitarbeiter (aus eigener Liste) dürfen gelöscht werden\n                            JSON.parse(localStorage.getItem('local_employees') || '[]').includes(employee.id)\n                          }\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    </td>\n                    {currentWeek.map((date) => {\n                      const entry = getAttendanceForEmployeeAndDate(employee.id, date);\n                      const dogCount = getDogCountForDate(date);\n                      const displayStatus: AttendanceStatus | null = entry?.status ?? 'absent';\n                      \n                      // Lock-Symbol nur anzeigen wenn Passwort nötig UND nicht im localStorage vorhanden/passend\n                      const storedPassword = getStoredPassword();\n                      const isProtected = entry && entry.password && !canModifyEntry(entry) && \n                                         (!storedPassword || storedPassword !== entry.password);\n                      \n                      return (\n                        <td \n                          key={date.toISOString()} \n                          className=\"px-2 py-3 text-center relative\"\n                        >\n                          <div className=\"flex items-center justify-center gap-1\">\n                            <div \n                              className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${getStatusColor(displayStatus)} cursor-pointer hover:opacity-80 transition-opacity`}\n                              onClick={() => handleCellClick(employee.id, date)}\n                            >\n                              {getStatusIcon(displayStatus)}\n                              <span className=\"ml-1\">{getStatusText(displayStatus)}</span>\n                              {isProtected && (\n                                <span title=\"Passwortgeschützt\">\n                                  <Lock className=\"w-3 h-3 ml-1 opacity-50\" />\n                                </span>\n                              )}\n                            </div>\n                            {entry && entry.status !== 'absent' && (\n                              <button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleDeleteEntry(employee.id, date, entry);\n                                }}\n                                className=\"p-1 hover:bg-red-100 rounded-full text-red-600 transition-colors opacity-0 group-hover:opacity-100\"\n                                title=\"Eintrag löschen\"\n                              >\n                                <Trash2 className=\"w-3 h-3\" />\n                              </button>\n                            )}\n                          </div>\n\n                        </td>\n                      );\n                    })}\n                  </tr>\n                ))}\n                \n                {/* Neue Mitarbeiter-Zeile */}\n                <tr className=\"bg-gray-50 hover:bg-gray-100\">\n                  <td className=\"px-4 py-4 whitespace-nowrap\">\n                    <div className=\"flex items-start space-x-4\">\n                      <div className=\"flex-shrink-0 h-8 w-8\">\n                        <div className=\"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center\">\n                          <Plus className=\"w-4 h-4 text-green-600\" />\n                        </div>\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <div>\n                          <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                            Name\n                          </label>\n                          <input\n                            type=\"text\"\n                            placeholder=\"Vollständiger Name...\"\n                            value={newEmployeeName}\n                            onChange={(e) => setNewEmployeeName(e.target.value)}\n                            className=\"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                            onKeyPress={(e) => e.key === 'Enter' && handleAddEmployee()}\n                          />\n                        </div>\n                      </div>\n                      <div className=\"flex-shrink-0 flex items-center mt-6\">\n                        <button\n                          onClick={handleAddEmployee}\n                          disabled={!newEmployeeName.trim()}\n                          className=\"px-4 py-1.5 text-sm font-medium bg-green-700 text-white rounded-md hover:bg-green-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors whitespace-nowrap\"\n                        >\n                          Hinzufügen\n                        </button>\n                      </div>\n                    </div>\n                  </td>\n                  {currentWeek.map((date) => (\n                    <td key={date.toISOString()} className=\"px-2 py-4 text-center\">\n                    </td>\n                  ))}\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Passwort-Modal */}\n      {showPasswordModal && (\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\n          <div className=\"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white\">\n            <div className=\"mt-3\">\n              <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\n                {passwordModalType === 'set' ? 'Passwort festlegen' : 'Passwort eingeben'}\n              </h3>\n              \n              <div className=\"space-y-4\">\n                {passwordModalType === 'set' && (\n                  <p className=\"text-sm text-gray-600\">\n                    Bitte lege ein Passwort fest. Dieses Passwort wird auf diesem Gerät gespeichert und ermöglicht es dir, \n                    deine Einträge auch von anderen Geräten aus zu bearbeiten. Du brauchst es nur einmal pro Gerät einzugeben.\n                  </p>\n                )}\n                {passwordModalType === 'verify' && (\n                  <p className=\"text-sm text-gray-600\">\n                    Dieser Eintrag wurde von einem anderen Gerät erstellt. Bitte gib das Passwort ein, um ihn zu bearbeiten.\n                  </p>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Passwort\n                  </label>\n                  <input\n                    type=\"password\"\n                    value={passwordInput}\n                    onChange={(e) => setPasswordInput(e.target.value)}\n                    className=\"input-field\"\n                    placeholder=\"Passwort eingeben\"\n                    onKeyPress={(e) => {\n                      if (e.key === 'Enter') {\n                        handlePasswordSubmit();\n                      }\n                    }}\n                    autoFocus\n                    required\n                  />\n                </div>\n\n                <div className=\"flex justify-end space-x-3 pt-4\">\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setShowPasswordModal(false);\n                      setPendingAction(null);\n                      setPasswordInput('');\n                    }}\n                    className=\"btn-secondary\"\n                  >\n                    Abbrechen\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={handlePasswordSubmit}\n                    className=\"btn-primary\"\n                  >\n                    {passwordModalType === 'set' ? 'Erstellen' : 'Bestätigen'}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AttendanceCalendar;\n\n"],"mappings":"+IAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,MAAM,CAAEC,WAAW,CAAEC,OAAO,CAAEC,OAAO,KAAQ,UAAU,CAChE,OAASC,EAAE,KAAQ,iBAAiB,CACpC,OAASC,WAAW,CAAEC,YAAY,CAAEC,IAAI,CAAEC,CAAC,CAAEC,IAAI,CAAEC,GAAG,CAAEC,MAAM,CAAEC,IAAI,KAAQ,cAAc,CAE1F,OAASC,OAAO,KAAQ,kBAAkB,CAC1C,OAASC,WAAW,KAAQ,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAOhD,KAAM,CAAAC,kBAAqD,CAAGC,IAAA,EAAoC,IAAnC,CAAEC,YAAY,CAAEC,YAAa,CAAC,CAAAF,IAAA,CAC3F,KAAM,CAACG,SAAS,CAAEC,YAAY,CAAC,CAAG1B,QAAQ,CAAa,EAAE,CAAC,CAC1D,KAAM,CAAC2B,UAAU,CAAEC,aAAa,CAAC,CAAG5B,QAAQ,CAAoB,EAAE,CAAC,CACnE,KAAM,CAAC6B,WAAW,CAAEC,cAAc,CAAC,CAAG9B,QAAQ,CAAS,EAAE,CAAC,CAC1D,KAAM,CAAC+B,eAAe,CAAEC,kBAAkB,CAAC,CAAGhC,QAAQ,CAAC,EAAE,CAAC,CAC1D,KAAM,CAACiC,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGlC,QAAQ,CAAC,KAAK,CAAC,CACjE,KAAM,CAACmC,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGpC,QAAQ,CAAmB,KAAK,CAAC,CACnF,KAAM,CAACqC,aAAa,CAAEC,gBAAgB,CAAC,CAAGtC,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAACuC,aAAa,CAAEC,gBAAgB,CAAC,CAAGxC,QAAQ,CAAmE,IAAI,CAAC,CAE1HC,SAAS,CAAC,IAAM,CACdwC,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC,CAEnDC,QAAQ,CAAC,CAAC,CACVC,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAAE,EAAE,CAAC,CAEN3C,SAAS,CAAC,IAAM,CACd2C,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAAE,CAACrB,YAAY,CAAC,CAAC,CAElB;AACAtB,SAAS,CAAC,IAAM,CACd,KAAM,CAAA4C,WAAW,CAAG9B,OAAO,CAAC+B,YAAY,CAAC,IAAM,CAC7CL,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC,CACrDC,QAAQ,CAAC,CAAC,CACZ,CAAC,CAAC,CAEF,MAAO,CAAAE,WAAW,CACpB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAF,QAAQ,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAI,CACF;AACA,KAAM,CAAA5B,OAAO,CAACgC,2BAA2B,CAAC,CAAC,CAE3C,KAAM,CAACC,YAAY,CAAEC,aAAa,CAAC,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAAC,CACtDpC,OAAO,CAACqC,YAAY,CAAC,CAAC,CACtBrC,OAAO,CAACsC,aAAa,CAAC,CAAC,CACxB,CAAC,CAEF;AACA,GAAIL,YAAY,CAACM,MAAM,CAAG,CAAC,CAAE,CAC3B,KAAM,CAAAC,gBAAgB,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAC,EAAI,IAAI,CAAC,CAEpFX,YAAY,CAACY,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CAC1B,KAAM,CAAAC,QAAQ,CAAGR,gBAAgB,CAACS,QAAQ,CAACH,CAAC,CAACI,EAAE,CAAC,CAChD,KAAM,CAAAC,QAAQ,CAAGX,gBAAgB,CAACS,QAAQ,CAACF,CAAC,CAACG,EAAE,CAAC,CAEhD;AACA,GAAIF,QAAQ,EAAI,CAACG,QAAQ,CAAE,MAAO,CAAC,CAAC,CACpC,GAAI,CAACH,QAAQ,EAAIG,QAAQ,CAAE,MAAO,EAAC,CAEnC;AACA,KAAM,CAAAC,GAAG,CAAGC,QAAQ,CAACP,CAAC,CAACI,EAAE,CAAC,CAC1B,KAAM,CAAAI,GAAG,CAAGD,QAAQ,CAACN,CAAC,CAACG,EAAE,CAAC,CAC1B,MAAO,CAAAE,GAAG,CAAGE,GAAG,CAClB,CAAC,CAAC,CACJ,CAEA3C,YAAY,CAACsB,YAAY,CAAC,CAC1BpB,aAAa,CAACqB,aAAa,CAAC,CAC9B,CAAE,MAAOqB,KAAK,CAAE,CACd7B,OAAO,CAAC6B,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACpD;AACA5C,YAAY,CAAC,EAAE,CAAC,CAChBE,aAAa,CAAC,EAAE,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAgB,gBAAgB,CAAGA,CAAA,GAAM,CAC7B,KAAM,CAAA2B,SAAS,CAAGpE,WAAW,CAACoB,YAAY,CAAE,CAAEiD,YAAY,CAAE,CAAE,CAAC,CAAC,CAChE,KAAM,CAAAC,IAAY,CAAG,EAAE,CACvB;AACA,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAG,CAAC,CAAEA,CAAC,EAAE,CAAE,CAC1BD,IAAI,CAACE,IAAI,CAACvE,OAAO,CAACmE,SAAS,CAAEG,CAAC,CAAC,CAAC,CAClC,CACA5C,cAAc,CAAC2C,IAAI,CAAC,CACtB,CAAC,CAED,KAAM,CAAAG,aAAa,CAAIC,MAA+B,EAAK,CACzD,GAAI,CAACA,MAAM,CAAE,mBAAO3D,IAAA,CAACR,CAAC,EAACoE,SAAS,CAAC,sBAAsB,CAAE,CAAC,CAAE;AAE5D,OAAQD,MAAM,EACZ,IAAK,SAAS,CACZ,mBAAO3D,IAAA,CAACT,IAAI,EAACqE,SAAS,CAAC,wBAAwB,CAAE,CAAC,CACpD,IAAK,kBAAkB,CACrB,mBAAO5D,IAAA,CAACN,GAAG,EAACkE,SAAS,CAAC,yBAAyB,CAAE,CAAC,CACpD,IAAK,QAAQ,CACX,mBAAO5D,IAAA,CAACR,CAAC,EAACoE,SAAS,CAAC,sBAAsB,CAAE,CAAC,CAC/C,QACE,mBAAO5D,IAAA,CAACR,CAAC,EAACoE,SAAS,CAAC,sBAAsB,CAAE,CAAC,CACjD,CACF,CAAC,CAED,KAAM,CAAAC,cAAc,CAAIF,MAA+B,EAAK,CAC1D,GAAI,CAACA,MAAM,CAAE,MAAO,wCAAwC,CAAE;AAE9D,OAAQA,MAAM,EACZ,IAAK,SAAS,CACZ,MAAO,8CAA8C,CACvD,IAAK,kBAAkB,CACrB,MAAO,iDAAiD,CAC1D,IAAK,QAAQ,CACX,MAAO,wCAAwC,CACjD,QACE,MAAO,wCAAwC,CACnD,CACF,CAAC,CAED,KAAM,CAAAG,aAAa,CAAIH,MAA+B,EAAK,CACzD,GAAI,CAACA,MAAM,CAAE,MAAO,UAAU,CAE9B,OAAQA,MAAM,EACZ,IAAK,SAAS,CACZ,MAAO,UAAU,CACnB,IAAK,kBAAkB,CACrB,MAAO,UAAU,CACnB,IAAK,QAAQ,CACX,MAAO,UAAU,CACnB,QACE,MAAO,UAAU,CACrB,CACF,CAAC,CAED,KAAM,CAAAI,+BAA+B,CAAGA,CAACC,UAAkB,CAAEC,IAAU,GAAK,CAC1E,KAAM,CAAAC,OAAO,CAAGlF,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAC,CAC1C,MAAO,CAAAxD,UAAU,CAAC0D,IAAI,CAACC,KAAK,EAC1BA,KAAK,CAACJ,UAAU,GAAKA,UAAU,EAAII,KAAK,CAACH,IAAI,GAAKC,OACpD,CAAC,CACH,CAAC,CAED,KAAM,CAAAG,kBAAkB,CAAIJ,IAAU,EAAK,CACzC,KAAM,CAAAC,OAAO,CAAGlF,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAC,CAC1C,MAAO,CAAAxD,UAAU,CAAC6D,MAAM,CAACF,KAAK,EAC5BA,KAAK,CAACH,IAAI,GAAKC,OAAO,EAAIE,KAAK,CAACT,MAAM,GAAK,kBAC7C,CAAC,CAACvB,MAAM,CACV,CAAC,CAED,KAAM,CAAAmC,qBAAqB,CAAIN,IAAU,EAAK,CAC5C,KAAM,CAAAC,OAAO,CAAGlF,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAC,CAC1C,MAAO,CAAAxD,UAAU,CAAC6D,MAAM,CAACF,KAAK,EAC5BA,KAAK,CAACH,IAAI,GAAKC,OAAO,GAAKE,KAAK,CAACT,MAAM,GAAK,SAAS,EAAIS,KAAK,CAACT,MAAM,GAAK,kBAAkB,CAC9F,CAAC,CAACvB,MAAM,CACV,CAAC,CAED,KAAM,CAAAoC,cAAc,CAAIJ,KAA8B,EAAc,CAClE,KAAM,CAAAK,QAAQ,CAAG3E,WAAW,CAAC,CAAC,CAC9B,GAAI,CAACsE,KAAK,CAAE,MAAO,KAAI,CAAE;AACzB,GAAI,CAACA,KAAK,CAACM,OAAO,CAAE,MAAO,KAAI,CAAE;AACjC,GAAIN,KAAK,CAACM,OAAO,GAAKD,QAAQ,CAAE,MAAO,KAAI,CAAE;AAC7C,MAAO,MAAK,CAAE;AAChB,CAAC,CAED,KAAM,CAAAE,iBAAiB,CAAGA,CAAA,GAAqB,CAC7C,MAAO,CAAAnC,YAAY,CAACC,OAAO,CAAC,qBAAqB,CAAC,CACpD,CAAC,CAED,KAAM,CAAAmC,iBAAiB,CAAIC,QAAgB,EAAW,CACpDrC,YAAY,CAACsC,OAAO,CAAC,qBAAqB,CAAED,QAAQ,CAAC,CACvD,CAAC,CAED,KAAM,CAAAE,eAAe,CAAG,KAAAA,CAAOf,UAAkB,CAAEC,IAAU,GAAK,CAChE,KAAM,CAAAe,aAAa,CAAGjB,+BAA+B,CAACC,UAAU,CAAEC,IAAI,CAAC,CAEvE;AACA,GAAIe,aAAa,EAAI,CAACR,cAAc,CAACQ,aAAa,CAAC,CAAE,CACnD;AACA,GAAIA,aAAa,CAACH,QAAQ,CAAE,CAC1B;AACA,KAAM,CAAAI,cAAc,CAAGN,iBAAiB,CAAC,CAAC,CAC1C,GAAIM,cAAc,EAAIA,cAAc,GAAKD,aAAa,CAACH,QAAQ,CAAE,CAC/D;AACA,KAAM,CAAAK,kBAAkB,CAAClB,UAAU,CAAEC,IAAI,CAAEe,aAAa,CAAC,CACzD,OACF,CAAC,IAAM,CACL;AACA1D,gBAAgB,CAAC,CAAE0C,UAAU,CAAEC,IAAI,CAAEG,KAAK,CAAEY,aAAc,CAAC,CAAC,CAC5D9D,oBAAoB,CAAC,QAAQ,CAAC,CAC9BE,gBAAgB,CAAC,EAAE,CAAC,CACpBJ,oBAAoB,CAAC,IAAI,CAAC,CAC1B,OACF,CACF,CAAC,IAAM,CACL;AACAmE,KAAK,CAAC,+GAA+G,CAAC,CACtH,OACF,CACF,CAEA,KAAM,CAAAC,QAAQ,CAAGf,kBAAkB,CAACJ,IAAI,CAAC,CACzC,KAAM,CAAAoB,WAAW,CAAGd,qBAAqB,CAACN,IAAI,CAAC,CAC/C,KAAM,CAAAC,OAAO,CAAGlF,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAC,CAE1C1C,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAE,CAC5BwC,UAAU,CACVC,IAAI,CAAEC,OAAO,CACboB,cAAc,CAAEN,aAAa,SAAbA,aAAa,iBAAbA,aAAa,CAAErB,MAAM,CACrCyB,QAAQ,CACRG,iBAAiB,CAAE9E,UAAU,CAAC6D,MAAM,CAACF,KAAK,EAAIA,KAAK,CAACH,IAAI,GAAKC,OAAO,CACtE,CAAC,CAAC,CAEF;AACA,KAAM,CAAAe,cAAc,CAAGN,iBAAiB,CAAC,CAAC,CAE1C,GAAI,CACF,GAAIK,aAAa,CAAE,CACjB;AACA;AACA,GAAI,CAACC,cAAc,CAAE,CACnB3D,gBAAgB,CAAC,CAAE0C,UAAU,CAAEC,IAAI,CAAEG,KAAK,CAAEY,aAAc,CAAC,CAAC,CAC5D9D,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,gBAAgB,CAAC,EAAE,CAAC,CACpBJ,oBAAoB,CAAC,IAAI,CAAC,CAC1B,OACF,CAEA;AACA,GAAI,CAAAwE,SAA2B,CAE/B,GAAIR,aAAa,CAACrB,MAAM,GAAK,QAAQ,CAAE,CACrC6B,SAAS,CAAG,SAAS,CACvB,CAAC,IAAM,IAAIR,aAAa,CAACrB,MAAM,GAAK,SAAS,CAAE,CAC7C;AACA,GAAIyB,QAAQ,EAAI,CAAC,CAAE,CACjBI,SAAS,CAAG,QAAQ,CACtB,CAAC,IAAM,CACLA,SAAS,CAAG,kBAAkB,CAChC,CACF,CAAC,IAAM,IAAIR,aAAa,CAACrB,MAAM,GAAK,kBAAkB,CAAE,CACtD6B,SAAS,CAAG,QAAQ,CACtB,CAAC,IAAM,CACLA,SAAS,CAAG,SAAS,CACvB,CAEA;AACA,KAAM,CAAAC,SAAS,CAAGT,aAAa,CAACrB,MAAM,GAAK,SAAS,EAAIqB,aAAa,CAACrB,MAAM,GAAK,kBAAkB,CACnG,KAAM,CAAA+B,YAAY,CAAGF,SAAS,GAAK,SAAS,EAAIA,SAAS,GAAK,kBAAkB,CAChF,KAAM,CAAAG,eAAe,CAAGN,WAAW,EAAIK,YAAY,EAAI,CAACD,SAAS,CAAG,CAAC,CAAG,CAAC,CAAC,EAAI,CAACC,YAAY,EAAID,SAAS,CAAG,CAAC,CAAG,CAAC,CAAC,CACjH,GAAIE,eAAe,CAAG,EAAE,EAAID,YAAY,CAAE,CACxCP,KAAK,CAAC,2FAA2F,CAAC,CACpG,CAEA,KAAM,CAAAS,YAA6B,CAAAC,aAAA,CAAAA,aAAA,IAC9Bb,aAAa,MAChBrB,MAAM,CAAE6B,SAAS,CACjBd,OAAO,CAAE5E,WAAW,CAAC,CAAC,CACtB+E,QAAQ,CAAEI,cAAgB;AAAA,EAC3B,CAED,KAAM,CAAApF,OAAO,CAACiG,kBAAkB,CAACF,YAAY,CAAC,CAChD,CAAC,IAAM,CACL;AACA;AACA,GAAI,CAACX,cAAc,CAAE,CACnB3D,gBAAgB,CAAC,CAAE0C,UAAU,CAAEC,IAAK,CAAC,CAAC,CACtC/C,oBAAoB,CAAC,KAAK,CAAC,CAC3BE,gBAAgB,CAAC,EAAE,CAAC,CACpBJ,oBAAoB,CAAC,IAAI,CAAC,CAC1B,OACF,CAEA;AACA,KAAM,CAAA+E,QAAyB,CAAG,CAChChD,EAAE,CAAEiD,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CACzBlC,UAAU,CAAEA,UAAU,CACtBC,IAAI,CAAEC,OAAO,CACbP,MAAM,CAAE,SAAS,CACjBe,OAAO,CAAE5E,WAAW,CAAC,CAAC,CACtB+E,QAAQ,CAAEI,cACZ,CAAC,CAED,KAAM,CAAApF,OAAO,CAACiG,kBAAkB,CAACC,QAAQ,CAAC,CAC5C,CAEA;AACA,KAAM,CAAAI,iBAAiB,CAAG,KAAM,CAAAtG,OAAO,CAACsC,aAAa,CAAC,CAAC,CACvDzB,aAAa,CAACyF,iBAAiB,CAAC,CAEhC5E,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAE,CAClCwC,UAAU,CACVC,IAAI,CAAEC,OAAO,CACbsB,SAAS,CAAER,aAAa,CAAG,SAAS,CAAG,SAAS,CAChDoB,sBAAsB,CAAED,iBAAiB,CAAC/D,MAAM,CAChDiE,cAAc,CAAEF,iBAAiB,CAAC7B,MAAM,CAACF,KAAK,EAAIA,KAAK,CAACH,IAAI,GAAKC,OAAO,CAAC,CAAC9B,MAC5E,CAAC,CAAC,CACJ,CAAE,MAAOgB,KAAK,CAAE,CACd7B,OAAO,CAAC6B,KAAK,CAAC,4CAA4C,CAAEA,KAAK,CAAC,CAClE+B,KAAK,CAAC,uEAAuE,CAAC,CAChF,CACF,CAAC,CAED,KAAM,CAAAmB,oBAAoB,CAAG,KAAAA,CAAA,GAAY,CACvC,GAAI,CAACjF,aAAa,CAAE,OAEpB,KAAM,CAAE2C,UAAU,CAAEC,IAAI,CAAEG,KAAM,CAAC,CAAG/C,aAAa,CACjD,KAAM,CAAA6C,OAAO,CAAGlF,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAC,CAE1C,GAAIhD,iBAAiB,GAAK,QAAQ,CAAE,CAClC;AACA,GAAI,CAACmD,KAAK,CAAE,OAEZ,GAAI,CAACjD,aAAa,CAACoF,IAAI,CAAC,CAAC,CAAE,CACzBpB,KAAK,CAAC,6BAA6B,CAAC,CACpC,OACF,CAEA,GAAIhE,aAAa,GAAKiD,KAAK,CAACS,QAAQ,CAAE,CACpCM,KAAK,CAAC,oBAAoB,CAAC,CAC3B,OACF,CAEA;AACAP,iBAAiB,CAACzD,aAAa,CAAC,CAEhC;AACAH,oBAAoB,CAAC,KAAK,CAAC,CAC3BM,gBAAgB,CAAC,IAAI,CAAC,CACtBF,gBAAgB,CAAC,EAAE,CAAC,CAEpB;AACA,KAAM,CAAA8D,kBAAkB,CAAClB,UAAU,CAAEC,IAAI,CAAEG,KAAK,CAAC,CACnD,CAAC,IAAM,CACL;AACA,GAAI,CAACjD,aAAa,CAACoF,IAAI,CAAC,CAAC,CAAE,CACzBpB,KAAK,CAAC,yHAAyH,CAAC,CAChI,OACF,CAEA;AACAP,iBAAiB,CAACzD,aAAa,CAAC,CAEhC,KAAM,CAAAiE,QAAQ,CAAGf,kBAAkB,CAACJ,IAAI,CAAC,CACzC,KAAM,CAAAoB,WAAW,CAAGd,qBAAqB,CAACN,IAAI,CAAC,CAE/C,GAAI,CACF,GAAIG,KAAK,CAAE,CACT;AACA,GAAI,CAAAoB,SAA2B,CAAG,SAAS,CAE3C,KAAM,CAAAC,SAAS,CAAGrB,KAAK,CAACT,MAAM,GAAK,SAAS,EAAIS,KAAK,CAACT,MAAM,GAAK,kBAAkB,CACnF,KAAM,CAAA+B,YAAY,CAAG,IAAI,CAAE;AAC3B,KAAM,CAAAC,eAAe,CAAGN,WAAW,EAAIK,YAAY,EAAI,CAACD,SAAS,CAAG,CAAC,CAAG,CAAC,CAAC,CAE1E,GAAIE,eAAe,CAAG,EAAE,CAAE,CACxBR,KAAK,CAAC,2FAA2F,CAAC,CACpG,CAEA,KAAM,CAAAS,YAA6B,CAAAC,aAAA,CAAAA,aAAA,IAC9BzB,KAAK,MACRT,MAAM,CAAE6B,SAAS,CACjBd,OAAO,CAAE5E,WAAW,CAAC,CAAC,CACtB+E,QAAQ,CAAE1D,aAAa,EACxB,CAED,KAAM,CAAAtB,OAAO,CAACiG,kBAAkB,CAACF,YAAY,CAAC,CAChD,CAAC,IAAM,CACL;AACA,GAAIP,WAAW,CAAG,CAAC,CAAG,EAAE,CAAE,CACxBF,KAAK,CAAC,2FAA2F,CAAC,CACpG,CAEA,KAAM,CAAAY,QAAyB,CAAG,CAChChD,EAAE,CAAEiD,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,CACzBlC,UAAU,CAAEA,UAAU,CACtBC,IAAI,CAAEC,OAAO,CACbP,MAAM,CAAE,SAAS,CACjBe,OAAO,CAAE5E,WAAW,CAAC,CAAC,CACtB+E,QAAQ,CAAE1D,aACZ,CAAC,CAED,KAAM,CAAAtB,OAAO,CAACiG,kBAAkB,CAACC,QAAQ,CAAC,CAC5C,CAEA,KAAM,CAAAI,iBAAiB,CAAG,KAAM,CAAAtG,OAAO,CAACsC,aAAa,CAAC,CAAC,CACvDzB,aAAa,CAACyF,iBAAiB,CAAC,CAEhCnF,oBAAoB,CAAC,KAAK,CAAC,CAC3BM,gBAAgB,CAAC,IAAI,CAAC,CACtBF,gBAAgB,CAAC,EAAE,CAAC,CACtB,CAAE,MAAOgC,KAAK,CAAE,CACd7B,OAAO,CAAC6B,KAAK,CAAC,wCAAwC,CAAEA,KAAK,CAAC,CAC9D+B,KAAK,CAAC,uEAAuE,CAAC,CAChF,CACF,CACF,CAAC,CAED,KAAM,CAAAD,kBAAkB,CAAG,KAAAA,CAAOlB,UAAkB,CAAEC,IAAU,CAAEe,aAA8B,GAAK,CACnG,KAAM,CAAAd,OAAO,CAAGlF,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAC,CAC1C,KAAM,CAAAmB,QAAQ,CAAGf,kBAAkB,CAACJ,IAAI,CAAC,CACzC,KAAM,CAAAoB,WAAW,CAAGd,qBAAqB,CAACN,IAAI,CAAC,CAE/C,GAAI,CACF;AACA,GAAI,CAAAuB,SAA2B,CAE/B,GAAIR,aAAa,CAACrB,MAAM,GAAK,QAAQ,CAAE,CACrC6B,SAAS,CAAG,SAAS,CACvB,CAAC,IAAM,IAAIR,aAAa,CAACrB,MAAM,GAAK,SAAS,CAAE,CAC7C;AACA,GAAIyB,QAAQ,EAAI,CAAC,CAAE,CACjBI,SAAS,CAAG,QAAQ,CACtB,CAAC,IAAM,CACLA,SAAS,CAAG,kBAAkB,CAChC,CACF,CAAC,IAAM,IAAIR,aAAa,CAACrB,MAAM,GAAK,kBAAkB,CAAE,CACtD6B,SAAS,CAAG,QAAQ,CACtB,CAAC,IAAM,CACLA,SAAS,CAAG,SAAS,CACvB,CAEA;AACA,KAAM,CAAAC,SAAS,CAAGT,aAAa,CAACrB,MAAM,GAAK,SAAS,EAAIqB,aAAa,CAACrB,MAAM,GAAK,kBAAkB,CACnG,KAAM,CAAA+B,YAAY,CAAGF,SAAS,GAAK,SAAS,EAAIA,SAAS,GAAK,kBAAkB,CAChF,KAAM,CAAAG,eAAe,CAAGN,WAAW,EAAIK,YAAY,EAAI,CAACD,SAAS,CAAG,CAAC,CAAG,CAAC,CAAC,EAAI,CAACC,YAAY,EAAID,SAAS,CAAG,CAAC,CAAG,CAAC,CAAC,CACjH,GAAIE,eAAe,CAAG,EAAE,EAAID,YAAY,CAAE,CACxCP,KAAK,CAAC,2FAA2F,CAAC,CACpG,CAEA,KAAM,CAAAS,YAA6B,CAAAC,aAAA,CAAAA,aAAA,IAC9Bb,aAAa,MAChBrB,MAAM,CAAE6B,SAAS,EAClB,CAED,KAAM,CAAA3F,OAAO,CAACiG,kBAAkB,CAACF,YAAY,CAAC,CAE9C;AACA,KAAM,CAAAO,iBAAiB,CAAG,KAAM,CAAAtG,OAAO,CAACsC,aAAa,CAAC,CAAC,CACvDzB,aAAa,CAACyF,iBAAiB,CAAC,CAClC,CAAE,MAAO/C,KAAK,CAAE,CACd7B,OAAO,CAAC6B,KAAK,CAAC,4CAA4C,CAAEA,KAAK,CAAC,CAClE+B,KAAK,CAAC,uEAAuE,CAAC,CAChF,CACF,CAAC,CAED,KAAM,CAAAqB,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CAAC3F,eAAe,CAAC0F,IAAI,CAAC,CAAC,CAAE,OAE7B,GAAI,CACF,KAAM,CAAAE,WAAW,CAAG,KAAM,CAAA5G,OAAO,CAAC6G,WAAW,CAAC,CAC5CC,IAAI,CAAE9F,eAAe,CAAC0F,IAAI,CAAC,CAAC,CAC5BK,UAAU,CAAE,WAAa;AAC3B,CAAC,CAAC,CAEF;AACA,KAAM,CAAAC,cAAc,CAAGvE,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAC,EAAI,IAAI,CAAC,CAClFoE,cAAc,CAACpD,IAAI,CAACgD,WAAW,CAAC1D,EAAE,CAAC,CACnCP,YAAY,CAACsC,OAAO,CAAC,iBAAiB,CAAExC,IAAI,CAACwE,SAAS,CAACD,cAAc,CAAC,CAAC,CAEvE/F,kBAAkB,CAAC,EAAE,CAAC,CACtB,KAAM,CAAAW,QAAQ,CAAC,CAAC,CAAE;AACpB,CAAE,MAAO2B,KAAK,CAAE,CACd7B,OAAO,CAAC6B,KAAK,CAAC,0CAA0C,CAAEA,KAAK,CAAC,CAChE+B,KAAK,CAAC,yEAAyE,CAAC,CAClF,CACF,CAAC,CAED,KAAM,CAAA4B,iBAAiB,CAAG,KAAAA,CAAO/C,UAAkB,CAAEC,IAAU,CAAEG,KAAsB,GAAK,CAC1F;AACA,GAAI,CAACI,cAAc,CAACJ,KAAK,CAAC,CAAE,CAC1B;AACA,GAAIA,KAAK,CAACS,QAAQ,CAAE,CAClB;AACA,KAAM,CAAAI,cAAc,CAAGN,iBAAiB,CAAC,CAAC,CAC1C,GAAI,CAACM,cAAc,EAAIA,cAAc,GAAKb,KAAK,CAACS,QAAQ,CAAE,CACxD;AACAM,KAAK,CAAC,gIAAgI,CAAC,CACvI,OACF,CACF,CAAC,IAAM,CACLA,KAAK,CAAC,6GAA6G,CAAC,CACpH,OACF,CACF,CAEA,KAAM,CAAA6B,QAAQ,CAAGzG,SAAS,CAAC4D,IAAI,CAAC8C,GAAG,EAAIA,GAAG,CAAClE,EAAE,GAAKiB,UAAU,CAAC,CAC7D,KAAM,CAAAE,OAAO,CAAGlF,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAC,CAE1C,GAAIiD,MAAM,CAACC,OAAO,mBAAAC,MAAA,CAAgBJ,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEL,IAAI,SAAAS,MAAA,CAAOpI,MAAM,CAACiF,IAAI,CAAE,YAAY,CAAE,CAAEoD,MAAM,CAAEjI,EAAG,CAAC,CAAC,gBAAW,CAAC,CAAE,CAC7G,GAAI,CACF,KAAM,CAAAS,OAAO,CAACyH,qBAAqB,CAACtD,UAAU,CAAEE,OAAO,CAAC,CACxD,KAAM,CAAAiC,iBAAiB,CAAG,KAAM,CAAAtG,OAAO,CAACsC,aAAa,CAAC,CAAC,CACvDzB,aAAa,CAACyF,iBAAiB,CAAC,CAClC,CAAE,MAAO/C,KAAK,CAAE,CACd7B,OAAO,CAAC6B,KAAK,CAAC,mCAAmC,CAAEA,KAAK,CAAC,CACzD+B,KAAK,CAAC,kEAAkE,CAAC,CAC3E,CACF,CACF,CAAC,CAED,KAAM,CAAAoC,oBAAoB,CAAG,KAAO,CAAAvD,UAAkB,EAAK,CACzD,KAAM,CAAAgD,QAAQ,CAAGzG,SAAS,CAAC4D,IAAI,CAAC8C,GAAG,EAAIA,GAAG,CAAClE,EAAE,GAAKiB,UAAU,CAAC,CAC7D,GAAI,CAACgD,QAAQ,CAAE,OAEf,KAAM,CAAAQ,cAAc,gCAAAJ,MAAA,CAAiCJ,QAAQ,CAACL,IAAI,0FAA8E,CAEhJ,GAAIO,MAAM,CAACC,OAAO,CAACK,cAAc,CAAC,CAAE,CAClC,GAAI,CACF,KAAM,CAAA3H,OAAO,CAAC4H,cAAc,CAACzD,UAAU,CAAC,CACxCxD,YAAY,CAACD,SAAS,CAAC+D,MAAM,CAAC2C,GAAG,EAAIA,GAAG,CAAClE,EAAE,GAAKiB,UAAU,CAAC,CAAC,CAE5D;AACA,KAAM,CAAA6C,cAAc,CAAGvE,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAC,EAAI,IAAI,CAAC,CAClF,KAAM,CAAAiF,qBAAqB,CAAGb,cAAc,CAACvC,MAAM,CAAEvB,EAAU,EAAKA,EAAE,GAAKiB,UAAU,CAAC,CACtFxB,YAAY,CAACsC,OAAO,CAAC,iBAAiB,CAAExC,IAAI,CAACwE,SAAS,CAACY,qBAAqB,CAAC,CAAC,CAE9E;AACA,KAAM,CAAAC,iBAAiB,CAAGlH,UAAU,CAAC6D,MAAM,CAACF,KAAK,EAAIA,KAAK,CAACJ,UAAU,GAAKA,UAAU,CAAC,CACrFtD,aAAa,CAACiH,iBAAiB,CAAC,CAEhCpG,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAE,CAC/CoG,YAAY,CAAEZ,QAAQ,CAACL,IAAI,CAC3B3C,UAAU,CACV6D,wBAAwB,CAAEpH,UAAU,CAAC2B,MAAM,CAAGuF,iBAAiB,CAACvF,MAClE,CAAC,CAAC,CACJ,CAAE,MAAOgB,KAAK,CAAE,CACd7B,OAAO,CAAC6B,KAAK,CAAC,uCAAuC,CAAEA,KAAK,CAAC,CAC7D+B,KAAK,CAAC,sEAAsE,CAAC,CAC/E,CACF,CACF,CAAC,CAED,KAAM,CAAA2C,kBAAkB,CAAGA,CAAA,GAAM,CAC/B,KAAM,CAAAC,OAAO,CAAG7I,OAAO,CAACmB,YAAY,CAAE,CAAC,CAAC,CAAC,CACzCC,YAAY,CAACyH,OAAO,CAAC,CACvB,CAAC,CAED,KAAM,CAAAC,cAAc,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAAAD,OAAO,CAAG7I,OAAO,CAACmB,YAAY,CAAE,CAAC,CAAC,CACxCC,YAAY,CAACyH,OAAO,CAAC,CACvB,CAAC,CAED,KAAM,CAAAE,aAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,gBAAgB,CAAGjJ,WAAW,CAAC,GAAI,CAAA+G,IAAI,CAAC,CAAC,CAAE,CAAE1C,YAAY,CAAE,CAAE,CAAC,CAAC,CACrE,KAAM,CAAA6E,iBAAiB,CAAGlJ,WAAW,CAACoB,YAAY,CAAE,CAAEiD,YAAY,CAAE,CAAE,CAAC,CAAC,CACxE,MAAO,CAAA4E,gBAAgB,CAACE,OAAO,CAAC,CAAC,GAAKD,iBAAiB,CAACC,OAAO,CAAC,CAAC,CACnE,CAAC,CAED,mBACElI,KAAA,QAAK0D,SAAS,CAAC,WAAW,CAAAyE,QAAA,eAExBrI,IAAA,QAAK4D,SAAS,CAAC,mCAAmC,CAAAyE,QAAA,cAChDnI,KAAA,QAAK0D,SAAS,CAAC,6BAA6B,CAAAyE,QAAA,EACzC,CAACJ,aAAa,CAAC,CAAC,eACfjI,IAAA,WACEsI,OAAO,CAAER,kBAAmB,CAC5BlE,SAAS,CAAC,oDAAoD,CAAAyE,QAAA,cAE9DrI,IAAA,CAACX,WAAW,EAACuE,SAAS,CAAC,SAAS,CAAE,CAAC,CAC7B,CACT,cAED1D,KAAA,QAAK0D,SAAS,CAAC,aAAa,CAAAyE,QAAA,eAC1BrI,IAAA,OAAI4D,SAAS,CAAC,qCAAqC,CAAAyE,QAAA,CAChD1H,WAAW,CAACyB,MAAM,CAAG,CAAC,IAAAgF,MAAA,CAClBpI,MAAM,CAAC2B,WAAW,CAAC,CAAC,CAAC,CAAE,YAAY,CAAE,CAAE0G,MAAM,CAAEjI,EAAG,CAAC,CAAC,QAAAgI,MAAA,CAAMpI,MAAM,CAAC2B,WAAW,CAAC,CAAC,CAAC,CAAE,YAAY,CAAE,CAAE0G,MAAM,CAAEjI,EAAG,CAAC,CAAC,EAEjH,kBACD,CACC,CAAC,CACJuB,WAAW,CAACyB,MAAM,CAAG,CAAC,eACrBpC,IAAA,QAAK4D,SAAS,CAAC,uEAAuE,CAAAyE,QAAA,cACpFnI,KAAA,QAAK0D,SAAS,CAAC,mBAAmB,CAAAyE,QAAA,eAChCrI,IAAA,CAACT,IAAI,EAACqE,SAAS,CAAC,cAAc,CAAE,CAAC,cACjC1D,KAAA,SAAM0D,SAAS,IAAAwD,MAAA,CAAK7C,qBAAqB,CAAClE,YAAY,CAAC,EAAI,EAAE,CAAG,0BAA0B,CAAG,EAAE,CAAG,CAAAgI,QAAA,EAC/F9D,qBAAqB,CAAClE,YAAY,CAAC,CAAC,qBAAgB,CAACrB,MAAM,CAACqB,YAAY,CAAE,YAAY,CAAE,CAAEgH,MAAM,CAAEjI,EAAG,CAAC,CAAC,CAAC,GAC3G,EAAM,CAAC,EACJ,CAAC,CACH,CACN,EACE,CAAC,cAENY,IAAA,WACEsI,OAAO,CAAEN,cAAe,CACxBpE,SAAS,CAAC,oDAAoD,CAAAyE,QAAA,cAE9DrI,IAAA,CAACV,YAAY,EAACsE,SAAS,CAAC,SAAS,CAAE,CAAC,CAC9B,CAAC,EACN,CAAC,CACH,CAAC,CAGLjD,WAAW,CAACyB,MAAM,CAAG,CAAC,eACrBpC,IAAA,QAAK4D,SAAS,CAAC,4CAA4C,CAAAyE,QAAA,cACzDrI,IAAA,QAAK4D,SAAS,CAAC,iBAAiB,CAAAyE,QAAA,cAC9BnI,KAAA,UAAO0D,SAAS,CAAC,QAAQ,CAAAyE,QAAA,eACvBrI,IAAA,UAAO4D,SAAS,CAAC,YAAY,CAAAyE,QAAA,cAC3BnI,KAAA,OAAAmI,QAAA,eACErI,IAAA,OAAI4D,SAAS,CAAC,gFAAgF,CAAAyE,QAAA,CAAC,aAE/F,CAAI,CAAC,CACJ1H,WAAW,CAAC4H,GAAG,CAAEtE,IAAI,eACpBjE,IAAA,OAA6B4D,SAAS,CAAC,kFAAkF,CAAAyE,QAAA,cACvHnI,KAAA,QAAK0D,SAAS,CAAC,4BAA4B,CAAAyE,QAAA,eACzCrI,IAAA,SAAM4D,SAAS,CAAC,uBAAuB,CAAAyE,QAAA,CACpCrJ,MAAM,CAACiF,IAAI,CAAE,KAAK,CAAE,CAAEoD,MAAM,CAAEjI,EAAG,CAAC,CAAC,CAChC,CAAC,cACPY,IAAA,SAAM4D,SAAS,wBAAAwD,MAAA,CACbjI,OAAO,CAAC8E,IAAI,CAAC,CAAG,iFAAiF,CAAG,EAAE,CACrG,CAAAoE,QAAA,CACArJ,MAAM,CAACiF,IAAI,CAAE,IAAI,CAAC,CACf,CAAC,cACP/D,KAAA,SAAM0D,SAAS,qBAAAwD,MAAA,CAAsB7C,qBAAqB,CAACN,IAAI,CAAC,EAAI,EAAE,CAAG,0BAA0B,CAAG,eAAe,CAAG,CAAAoE,QAAA,EACrH9D,qBAAqB,CAACN,IAAI,CAAC,CAAC,KAC/B,EAAM,CAAC,EACJ,CAAC,EAbCA,IAAI,CAACuE,WAAW,CAAC,CActB,CACL,CAAC,EACA,CAAC,CACA,CAAC,cACRtI,KAAA,UAAO0D,SAAS,CAAC,mCAAmC,CAAAyE,QAAA,EACjD9H,SAAS,CAACgI,GAAG,CAAEvB,QAAQ,eACtB9G,KAAA,OAAsB0D,SAAS,CAAC,wBAAwB,CAAAyE,QAAA,eACtDrI,IAAA,OAAI4D,SAAS,CAAC,6BAA6B,CAAAyE,QAAA,cACzCnI,KAAA,QAAK0D,SAAS,CAAC,mCAAmC,CAAAyE,QAAA,eAChDnI,KAAA,QAAK0D,SAAS,CAAC,mBAAmB,CAAAyE,QAAA,eAChCrI,IAAA,QAAK4D,SAAS,CAAC,uBAAuB,CAAAyE,QAAA,cACpCrI,IAAA,QAAK4D,SAAS,CAAC,mEAAmE,CAAAyE,QAAA,cAChFrI,IAAA,SAAM4D,SAAS,CAAC,mCAAmC,CAAAyE,QAAA,CAChDrB,QAAQ,CAACL,IAAI,CAAC8B,KAAK,CAAC,GAAG,CAAC,CAACF,GAAG,CAACG,CAAC,EAAIA,CAAC,CAAC,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC,CAC7C,CAAC,CACJ,CAAC,CACH,CAAC,cACN3I,IAAA,QAAK4D,SAAS,CAAC,MAAM,CAAAyE,QAAA,cACnBrI,IAAA,QAAK4D,SAAS,CAAC,mCAAmC,CAAAyE,QAAA,CAC/CrB,QAAQ,CAACL,IAAI,CACX,CAAC,CACH,CAAC,EACH,CAAC,cACN3G,IAAA,WACEsI,OAAO,CAAGM,CAAC,EAAK,CACdA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnBtB,oBAAoB,CAACP,QAAQ,CAACjE,EAAE,CAAC,CACnC,CAAE,CACFa,SAAS,CAAC,sFAAsF,CAChGkF,KAAK,CAAC,wBAAqB,CAC3BC,QAAQ,CAAE,CACR;AACAzG,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAC,EAAI,IAAI,CAAC,CAACK,QAAQ,CAACkE,QAAQ,CAACjE,EAAE,CACjF,CAAAsF,QAAA,cAEDrI,IAAA,CAACL,MAAM,EAACiE,SAAS,CAAC,SAAS,CAAE,CAAC,CACxB,CAAC,EACN,CAAC,CACJ,CAAC,CACJjD,WAAW,CAAC4H,GAAG,CAAEtE,IAAI,EAAK,KAAA+E,aAAA,CACzB,KAAM,CAAA5E,KAAK,CAAGL,+BAA+B,CAACiD,QAAQ,CAACjE,EAAE,CAAEkB,IAAI,CAAC,CAChE,KAAM,CAAAmB,QAAQ,CAAGf,kBAAkB,CAACJ,IAAI,CAAC,CACzC,KAAM,CAAAgF,aAAsC,EAAAD,aAAA,CAAG5E,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAET,MAAM,UAAAqF,aAAA,UAAAA,aAAA,CAAI,QAAQ,CAExE;AACA,KAAM,CAAA/D,cAAc,CAAGN,iBAAiB,CAAC,CAAC,CAC1C,KAAM,CAAAuE,WAAW,CAAG9E,KAAK,EAAIA,KAAK,CAACS,QAAQ,EAAI,CAACL,cAAc,CAACJ,KAAK,CAAC,GACjD,CAACa,cAAc,EAAIA,cAAc,GAAKb,KAAK,CAACS,QAAQ,CAAC,CAEzE,mBACE7E,IAAA,OAEE4D,SAAS,CAAC,gCAAgC,CAAAyE,QAAA,cAE1CnI,KAAA,QAAK0D,SAAS,CAAC,wCAAwC,CAAAyE,QAAA,eACrDnI,KAAA,QACE0D,SAAS,+EAAAwD,MAAA,CAAgFvD,cAAc,CAACoF,aAAa,CAAC,uDAAsD,CAC5KX,OAAO,CAAEA,CAAA,GAAMvD,eAAe,CAACiC,QAAQ,CAACjE,EAAE,CAAEkB,IAAI,CAAE,CAAAoE,QAAA,EAEjD3E,aAAa,CAACuF,aAAa,CAAC,cAC7BjJ,IAAA,SAAM4D,SAAS,CAAC,MAAM,CAAAyE,QAAA,CAAEvE,aAAa,CAACmF,aAAa,CAAC,CAAO,CAAC,CAC3DC,WAAW,eACVlJ,IAAA,SAAM8I,KAAK,CAAC,sBAAmB,CAAAT,QAAA,cAC7BrI,IAAA,CAACJ,IAAI,EAACgE,SAAS,CAAC,yBAAyB,CAAE,CAAC,CACxC,CACP,EACE,CAAC,CACLQ,KAAK,EAAIA,KAAK,CAACT,MAAM,GAAK,QAAQ,eACjC3D,IAAA,WACEsI,OAAO,CAAGM,CAAC,EAAK,CACdA,CAAC,CAACC,eAAe,CAAC,CAAC,CACnB9B,iBAAiB,CAACC,QAAQ,CAACjE,EAAE,CAAEkB,IAAI,CAAEG,KAAK,CAAC,CAC7C,CAAE,CACFR,SAAS,CAAC,oGAAoG,CAC9GkF,KAAK,CAAC,oBAAiB,CAAAT,QAAA,cAEvBrI,IAAA,CAACL,MAAM,EAACiE,SAAS,CAAC,SAAS,CAAE,CAAC,CACxB,CACT,EACE,CAAC,EA5BDK,IAAI,CAACuE,WAAW,CAAC,CA8BpB,CAAC,CAET,CAAC,CAAC,GA7EKxB,QAAQ,CAACjE,EA8Ed,CACL,CAAC,cAGF7C,KAAA,OAAI0D,SAAS,CAAC,8BAA8B,CAAAyE,QAAA,eAC1CrI,IAAA,OAAI4D,SAAS,CAAC,6BAA6B,CAAAyE,QAAA,cACzCnI,KAAA,QAAK0D,SAAS,CAAC,4BAA4B,CAAAyE,QAAA,eACzCrI,IAAA,QAAK4D,SAAS,CAAC,uBAAuB,CAAAyE,QAAA,cACpCrI,IAAA,QAAK4D,SAAS,CAAC,oEAAoE,CAAAyE,QAAA,cACjFrI,IAAA,CAACP,IAAI,EAACmE,SAAS,CAAC,wBAAwB,CAAE,CAAC,CACxC,CAAC,CACH,CAAC,cACN5D,IAAA,QAAK4D,SAAS,CAAC,gBAAgB,CAAAyE,QAAA,cAC7BnI,KAAA,QAAAmI,QAAA,eACErI,IAAA,UAAO4D,SAAS,CAAC,8CAA8C,CAAAyE,QAAA,CAAC,MAEhE,CAAO,CAAC,cACRrI,IAAA,UACEmJ,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,0BAAuB,CACnCC,KAAK,CAAExI,eAAgB,CACvByI,QAAQ,CAAGV,CAAC,EAAK9H,kBAAkB,CAAC8H,CAAC,CAACW,MAAM,CAACF,KAAK,CAAE,CACpDzF,SAAS,CAAC,yIAAyI,CACnJ4F,UAAU,CAAGZ,CAAC,EAAKA,CAAC,CAACa,GAAG,GAAK,OAAO,EAAIjD,iBAAiB,CAAC,CAAE,CAC7D,CAAC,EACC,CAAC,CACH,CAAC,cACNxG,IAAA,QAAK4D,SAAS,CAAC,sCAAsC,CAAAyE,QAAA,cACnDrI,IAAA,WACEsI,OAAO,CAAE9B,iBAAkB,CAC3BuC,QAAQ,CAAE,CAAClI,eAAe,CAAC0F,IAAI,CAAC,CAAE,CAClC3C,SAAS,CAAC,2KAA2K,CAAAyE,QAAA,CACtL,eAED,CAAQ,CAAC,CACN,CAAC,EACH,CAAC,CACJ,CAAC,CACJ1H,WAAW,CAAC4H,GAAG,CAAEtE,IAAI,eACpBjE,IAAA,OAA6B4D,SAAS,CAAC,uBAAuB,EAArDK,IAAI,CAACuE,WAAW,CAAC,CACtB,CACL,CAAC,EACA,CAAC,EACA,CAAC,EACH,CAAC,CACL,CAAC,CACH,CACN,CAGAzH,iBAAiB,eAChBf,IAAA,QAAK4D,SAAS,CAAC,4EAA4E,CAAAyE,QAAA,cACzFrI,IAAA,QAAK4D,SAAS,CAAC,uEAAuE,CAAAyE,QAAA,cACpFnI,KAAA,QAAK0D,SAAS,CAAC,MAAM,CAAAyE,QAAA,eACnBrI,IAAA,OAAI4D,SAAS,CAAC,wCAAwC,CAAAyE,QAAA,CACnDpH,iBAAiB,GAAK,KAAK,CAAG,oBAAoB,CAAG,mBAAmB,CACvE,CAAC,cAELf,KAAA,QAAK0D,SAAS,CAAC,WAAW,CAAAyE,QAAA,EACvBpH,iBAAiB,GAAK,KAAK,eAC1BjB,IAAA,MAAG4D,SAAS,CAAC,uBAAuB,CAAAyE,QAAA,CAAC,kOAGrC,CAAG,CACJ,CACApH,iBAAiB,GAAK,QAAQ,eAC7BjB,IAAA,MAAG4D,SAAS,CAAC,uBAAuB,CAAAyE,QAAA,CAAC,6GAErC,CAAG,CACJ,cAEDnI,KAAA,QAAAmI,QAAA,eACErI,IAAA,UAAO4D,SAAS,CAAC,8CAA8C,CAAAyE,QAAA,CAAC,UAEhE,CAAO,CAAC,cACRrI,IAAA,UACEmJ,IAAI,CAAC,UAAU,CACfE,KAAK,CAAElI,aAAc,CACrBmI,QAAQ,CAAGV,CAAC,EAAKxH,gBAAgB,CAACwH,CAAC,CAACW,MAAM,CAACF,KAAK,CAAE,CAClDzF,SAAS,CAAC,aAAa,CACvBwF,WAAW,CAAC,mBAAmB,CAC/BI,UAAU,CAAGZ,CAAC,EAAK,CACjB,GAAIA,CAAC,CAACa,GAAG,GAAK,OAAO,CAAE,CACrBnD,oBAAoB,CAAC,CAAC,CACxB,CACF,CAAE,CACFoD,SAAS,MACTC,QAAQ,MACT,CAAC,EACC,CAAC,cAENzJ,KAAA,QAAK0D,SAAS,CAAC,iCAAiC,CAAAyE,QAAA,eAC9CrI,IAAA,WACEmJ,IAAI,CAAC,QAAQ,CACbb,OAAO,CAAEA,CAAA,GAAM,CACbtH,oBAAoB,CAAC,KAAK,CAAC,CAC3BM,gBAAgB,CAAC,IAAI,CAAC,CACtBF,gBAAgB,CAAC,EAAE,CAAC,CACtB,CAAE,CACFwC,SAAS,CAAC,eAAe,CAAAyE,QAAA,CAC1B,WAED,CAAQ,CAAC,cACTrI,IAAA,WACEmJ,IAAI,CAAC,QAAQ,CACbb,OAAO,CAAEhC,oBAAqB,CAC9B1C,SAAS,CAAC,aAAa,CAAAyE,QAAA,CAEtBpH,iBAAiB,GAAK,KAAK,CAAG,WAAW,CAAG,YAAY,CACnD,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CACH,CACN,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAd,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}