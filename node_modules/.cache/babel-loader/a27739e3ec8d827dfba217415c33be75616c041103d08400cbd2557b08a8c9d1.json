{"ast":null,"code":"import{startOfWeek,subWeeks,format}from'date-fns';const STORAGE_KEYS={EMPLOYEES:'office_plan_employees',ATTENDANCE:'office_plan_attendance',DEPARTMENTS:'office_plan_departments'};// Standard-Abteilungen\nconst DEFAULT_DEPARTMENTS=[{id:'1',name:'IT',color:'#3b82f6'},{id:'2',name:'Marketing',color:'#10b981'},{id:'3',name:'Vertrieb',color:'#f59e0b'},{id:'4',name:'HR',color:'#8b5cf6'},{id:'5',name:'Finanzen',color:'#ef4444'}];// Standard-Mitarbeiter\nconst DEFAULT_EMPLOYEES=[{id:'1',name:'Max Mustermann',department:'IT'},{id:'2',name:'Anna Schmidt',department:'Marketing'},{id:'3',name:'Tom Weber',department:'Vertrieb'},{id:'4',name:'Lisa Müller',department:'HR'},{id:'5',name:'Peter Fischer',department:'Finanzen'}];export const storage={// Abteilungen\ngetDepartments:()=>{const stored=localStorage.getItem(STORAGE_KEYS.DEPARTMENTS);if(stored){return JSON.parse(stored);}// Erste Initialisierung\nlocalStorage.setItem(STORAGE_KEYS.DEPARTMENTS,JSON.stringify(DEFAULT_DEPARTMENTS));return DEFAULT_DEPARTMENTS;},setDepartments:departments=>{localStorage.setItem(STORAGE_KEYS.DEPARTMENTS,JSON.stringify(departments));},// Mitarbeiter\ngetEmployees:()=>{const stored=localStorage.getItem(STORAGE_KEYS.EMPLOYEES);if(stored){return JSON.parse(stored);}// Erste Initialisierung\nlocalStorage.setItem(STORAGE_KEYS.EMPLOYEES,JSON.stringify(DEFAULT_EMPLOYEES));return DEFAULT_EMPLOYEES;},setEmployees:employees=>{localStorage.setItem(STORAGE_KEYS.EMPLOYEES,JSON.stringify(employees));},// Anwesenheit\ngetAttendance:()=>{const stored=localStorage.getItem(STORAGE_KEYS.ATTENDANCE);const attendance=stored?JSON.parse(stored):[];// Alte Daten bereinigen (älter als 1 Woche)\nconst cleanedAttendance=storage.cleanOldAttendanceData(attendance);if(cleanedAttendance.length!==attendance.length){storage.setAttendance(cleanedAttendance);}return cleanedAttendance;},setAttendance:attendance=>{localStorage.setItem(STORAGE_KEYS.ATTENDANCE,JSON.stringify(attendance));},// Hilfsfunktionen\naddAttendanceEntry:entry=>{const attendance=storage.getAttendance();const existingIndex=attendance.findIndex(a=>a.employeeId===entry.employeeId&&a.date===entry.date);if(existingIndex>=0){attendance[existingIndex]=entry;}else{attendance.push(entry);}storage.setAttendance(attendance);},getAttendanceForDate:date=>{const attendance=storage.getAttendance();return attendance.filter(entry=>entry.date===date);},getAttendanceForEmployee:(employeeId,startDate,endDate)=>{const attendance=storage.getAttendance();return attendance.filter(entry=>{if(entry.employeeId!==employeeId)return false;if(startDate&&entry.date<startDate)return false;if(endDate&&entry.date>endDate)return false;return true;});},// Alte Anwesenheitsdaten bereinigen (älter als 1 Woche)\ncleanOldAttendanceData:attendance=>{const oneWeekAgo=startOfWeek(subWeeks(new Date(),1),{weekStartsOn:1});const cutoffDate=format(oneWeekAgo,'yyyy-MM-dd');return attendance.filter(entry=>entry.date>=cutoffDate);},// Daten zurücksetzen\nresetData:()=>{localStorage.removeItem(STORAGE_KEYS.EMPLOYEES);localStorage.removeItem(STORAGE_KEYS.ATTENDANCE);localStorage.removeItem(STORAGE_KEYS.DEPARTMENTS);}};","map":{"version":3,"names":["startOfWeek","subWeeks","format","STORAGE_KEYS","EMPLOYEES","ATTENDANCE","DEPARTMENTS","DEFAULT_DEPARTMENTS","id","name","color","DEFAULT_EMPLOYEES","department","storage","getDepartments","stored","localStorage","getItem","JSON","parse","setItem","stringify","setDepartments","departments","getEmployees","setEmployees","employees","getAttendance","attendance","cleanedAttendance","cleanOldAttendanceData","length","setAttendance","addAttendanceEntry","entry","existingIndex","findIndex","a","employeeId","date","push","getAttendanceForDate","filter","getAttendanceForEmployee","startDate","endDate","oneWeekAgo","Date","weekStartsOn","cutoffDate","resetData","removeItem"],"sources":["C:/Users/jassy/OneDrive/Desktop/work/office plan/src/utils/storage.ts"],"sourcesContent":["import { Employee, AttendanceEntry, Department } from '../types';\r\nimport { startOfWeek, subWeeks, format } from 'date-fns';\r\n\r\nconst STORAGE_KEYS = {\r\n  EMPLOYEES: 'office_plan_employees',\r\n  ATTENDANCE: 'office_plan_attendance',\r\n  DEPARTMENTS: 'office_plan_departments',\r\n};\r\n\r\n// Standard-Abteilungen\r\nconst DEFAULT_DEPARTMENTS: Department[] = [\r\n  { id: '1', name: 'IT', color: '#3b82f6' },\r\n  { id: '2', name: 'Marketing', color: '#10b981' },\r\n  { id: '3', name: 'Vertrieb', color: '#f59e0b' },\r\n  { id: '4', name: 'HR', color: '#8b5cf6' },\r\n  { id: '5', name: 'Finanzen', color: '#ef4444' },\r\n];\r\n\r\n// Standard-Mitarbeiter\r\nconst DEFAULT_EMPLOYEES: Employee[] = [\r\n  { id: '1', name: 'Max Mustermann', department: 'IT' },\r\n  { id: '2', name: 'Anna Schmidt', department: 'Marketing' },\r\n  { id: '3', name: 'Tom Weber', department: 'Vertrieb' },\r\n  { id: '4', name: 'Lisa Müller', department: 'HR' },\r\n  { id: '5', name: 'Peter Fischer', department: 'Finanzen' },\r\n];\r\n\r\nexport const storage = {\r\n  // Abteilungen\r\n  getDepartments: (): Department[] => {\r\n    const stored = localStorage.getItem(STORAGE_KEYS.DEPARTMENTS);\r\n    if (stored) {\r\n      return JSON.parse(stored);\r\n    }\r\n    // Erste Initialisierung\r\n    localStorage.setItem(STORAGE_KEYS.DEPARTMENTS, JSON.stringify(DEFAULT_DEPARTMENTS));\r\n    return DEFAULT_DEPARTMENTS;\r\n  },\r\n\r\n  setDepartments: (departments: Department[]): void => {\r\n    localStorage.setItem(STORAGE_KEYS.DEPARTMENTS, JSON.stringify(departments));\r\n  },\r\n\r\n  // Mitarbeiter\r\n  getEmployees: (): Employee[] => {\r\n    const stored = localStorage.getItem(STORAGE_KEYS.EMPLOYEES);\r\n    if (stored) {\r\n      return JSON.parse(stored);\r\n    }\r\n    // Erste Initialisierung\r\n    localStorage.setItem(STORAGE_KEYS.EMPLOYEES, JSON.stringify(DEFAULT_EMPLOYEES));\r\n    return DEFAULT_EMPLOYEES;\r\n  },\r\n\r\n  setEmployees: (employees: Employee[]): void => {\r\n    localStorage.setItem(STORAGE_KEYS.EMPLOYEES, JSON.stringify(employees));\r\n  },\r\n\r\n  // Anwesenheit\r\n  getAttendance: (): AttendanceEntry[] => {\r\n    const stored = localStorage.getItem(STORAGE_KEYS.ATTENDANCE);\r\n    const attendance = stored ? JSON.parse(stored) : [];\r\n    \r\n    // Alte Daten bereinigen (älter als 1 Woche)\r\n    const cleanedAttendance = storage.cleanOldAttendanceData(attendance);\r\n    if (cleanedAttendance.length !== attendance.length) {\r\n      storage.setAttendance(cleanedAttendance);\r\n    }\r\n    \r\n    return cleanedAttendance;\r\n  },\r\n\r\n  setAttendance: (attendance: AttendanceEntry[]): void => {\r\n    localStorage.setItem(STORAGE_KEYS.ATTENDANCE, JSON.stringify(attendance));\r\n  },\r\n\r\n  // Hilfsfunktionen\r\n  addAttendanceEntry: (entry: AttendanceEntry): void => {\r\n    const attendance = storage.getAttendance();\r\n    const existingIndex = attendance.findIndex(\r\n      a => a.employeeId === entry.employeeId && a.date === entry.date\r\n    );\r\n    \r\n    if (existingIndex >= 0) {\r\n      attendance[existingIndex] = entry;\r\n    } else {\r\n      attendance.push(entry);\r\n    }\r\n    \r\n    storage.setAttendance(attendance);\r\n  },\r\n\r\n  getAttendanceForDate: (date: string): AttendanceEntry[] => {\r\n    const attendance = storage.getAttendance();\r\n    return attendance.filter(entry => entry.date === date);\r\n  },\r\n\r\n  getAttendanceForEmployee: (employeeId: string, startDate?: string, endDate?: string): AttendanceEntry[] => {\r\n    const attendance = storage.getAttendance();\r\n    return attendance.filter(entry => {\r\n      if (entry.employeeId !== employeeId) return false;\r\n      if (startDate && entry.date < startDate) return false;\r\n      if (endDate && entry.date > endDate) return false;\r\n      return true;\r\n    });\r\n  },\r\n\r\n  // Alte Anwesenheitsdaten bereinigen (älter als 1 Woche)\r\n  cleanOldAttendanceData: (attendance: AttendanceEntry[]): AttendanceEntry[] => {\r\n    const oneWeekAgo = startOfWeek(subWeeks(new Date(), 1), { weekStartsOn: 1 });\r\n    const cutoffDate = format(oneWeekAgo, 'yyyy-MM-dd');\r\n    \r\n    return attendance.filter(entry => entry.date >= cutoffDate);\r\n  },\r\n\r\n  // Daten zurücksetzen\r\n  resetData: (): void => {\r\n    localStorage.removeItem(STORAGE_KEYS.EMPLOYEES);\r\n    localStorage.removeItem(STORAGE_KEYS.ATTENDANCE);\r\n    localStorage.removeItem(STORAGE_KEYS.DEPARTMENTS);\r\n  },\r\n};\r\n\r\n"],"mappings":"AACA,OAASA,WAAW,CAAEC,QAAQ,CAAEC,MAAM,KAAQ,UAAU,CAExD,KAAM,CAAAC,YAAY,CAAG,CACnBC,SAAS,CAAE,uBAAuB,CAClCC,UAAU,CAAE,wBAAwB,CACpCC,WAAW,CAAE,yBACf,CAAC,CAED;AACA,KAAM,CAAAC,mBAAiC,CAAG,CACxC,CAAEC,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,IAAI,CAAEC,KAAK,CAAE,SAAU,CAAC,CACzC,CAAEF,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,WAAW,CAAEC,KAAK,CAAE,SAAU,CAAC,CAChD,CAAEF,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,UAAU,CAAEC,KAAK,CAAE,SAAU,CAAC,CAC/C,CAAEF,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,IAAI,CAAEC,KAAK,CAAE,SAAU,CAAC,CACzC,CAAEF,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,UAAU,CAAEC,KAAK,CAAE,SAAU,CAAC,CAChD,CAED;AACA,KAAM,CAAAC,iBAA6B,CAAG,CACpC,CAAEH,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,gBAAgB,CAAEG,UAAU,CAAE,IAAK,CAAC,CACrD,CAAEJ,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,cAAc,CAAEG,UAAU,CAAE,WAAY,CAAC,CAC1D,CAAEJ,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,WAAW,CAAEG,UAAU,CAAE,UAAW,CAAC,CACtD,CAAEJ,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,aAAa,CAAEG,UAAU,CAAE,IAAK,CAAC,CAClD,CAAEJ,EAAE,CAAE,GAAG,CAAEC,IAAI,CAAE,eAAe,CAAEG,UAAU,CAAE,UAAW,CAAC,CAC3D,CAED,MAAO,MAAM,CAAAC,OAAO,CAAG,CACrB;AACAC,cAAc,CAAEA,CAAA,GAAoB,CAClC,KAAM,CAAAC,MAAM,CAAGC,YAAY,CAACC,OAAO,CAACd,YAAY,CAACG,WAAW,CAAC,CAC7D,GAAIS,MAAM,CAAE,CACV,MAAO,CAAAG,IAAI,CAACC,KAAK,CAACJ,MAAM,CAAC,CAC3B,CACA;AACAC,YAAY,CAACI,OAAO,CAACjB,YAAY,CAACG,WAAW,CAAEY,IAAI,CAACG,SAAS,CAACd,mBAAmB,CAAC,CAAC,CACnF,MAAO,CAAAA,mBAAmB,CAC5B,CAAC,CAEDe,cAAc,CAAGC,WAAyB,EAAW,CACnDP,YAAY,CAACI,OAAO,CAACjB,YAAY,CAACG,WAAW,CAAEY,IAAI,CAACG,SAAS,CAACE,WAAW,CAAC,CAAC,CAC7E,CAAC,CAED;AACAC,YAAY,CAAEA,CAAA,GAAkB,CAC9B,KAAM,CAAAT,MAAM,CAAGC,YAAY,CAACC,OAAO,CAACd,YAAY,CAACC,SAAS,CAAC,CAC3D,GAAIW,MAAM,CAAE,CACV,MAAO,CAAAG,IAAI,CAACC,KAAK,CAACJ,MAAM,CAAC,CAC3B,CACA;AACAC,YAAY,CAACI,OAAO,CAACjB,YAAY,CAACC,SAAS,CAAEc,IAAI,CAACG,SAAS,CAACV,iBAAiB,CAAC,CAAC,CAC/E,MAAO,CAAAA,iBAAiB,CAC1B,CAAC,CAEDc,YAAY,CAAGC,SAAqB,EAAW,CAC7CV,YAAY,CAACI,OAAO,CAACjB,YAAY,CAACC,SAAS,CAAEc,IAAI,CAACG,SAAS,CAACK,SAAS,CAAC,CAAC,CACzE,CAAC,CAED;AACAC,aAAa,CAAEA,CAAA,GAAyB,CACtC,KAAM,CAAAZ,MAAM,CAAGC,YAAY,CAACC,OAAO,CAACd,YAAY,CAACE,UAAU,CAAC,CAC5D,KAAM,CAAAuB,UAAU,CAAGb,MAAM,CAAGG,IAAI,CAACC,KAAK,CAACJ,MAAM,CAAC,CAAG,EAAE,CAEnD;AACA,KAAM,CAAAc,iBAAiB,CAAGhB,OAAO,CAACiB,sBAAsB,CAACF,UAAU,CAAC,CACpE,GAAIC,iBAAiB,CAACE,MAAM,GAAKH,UAAU,CAACG,MAAM,CAAE,CAClDlB,OAAO,CAACmB,aAAa,CAACH,iBAAiB,CAAC,CAC1C,CAEA,MAAO,CAAAA,iBAAiB,CAC1B,CAAC,CAEDG,aAAa,CAAGJ,UAA6B,EAAW,CACtDZ,YAAY,CAACI,OAAO,CAACjB,YAAY,CAACE,UAAU,CAAEa,IAAI,CAACG,SAAS,CAACO,UAAU,CAAC,CAAC,CAC3E,CAAC,CAED;AACAK,kBAAkB,CAAGC,KAAsB,EAAW,CACpD,KAAM,CAAAN,UAAU,CAAGf,OAAO,CAACc,aAAa,CAAC,CAAC,CAC1C,KAAM,CAAAQ,aAAa,CAAGP,UAAU,CAACQ,SAAS,CACxCC,CAAC,EAAIA,CAAC,CAACC,UAAU,GAAKJ,KAAK,CAACI,UAAU,EAAID,CAAC,CAACE,IAAI,GAAKL,KAAK,CAACK,IAC7D,CAAC,CAED,GAAIJ,aAAa,EAAI,CAAC,CAAE,CACtBP,UAAU,CAACO,aAAa,CAAC,CAAGD,KAAK,CACnC,CAAC,IAAM,CACLN,UAAU,CAACY,IAAI,CAACN,KAAK,CAAC,CACxB,CAEArB,OAAO,CAACmB,aAAa,CAACJ,UAAU,CAAC,CACnC,CAAC,CAEDa,oBAAoB,CAAGF,IAAY,EAAwB,CACzD,KAAM,CAAAX,UAAU,CAAGf,OAAO,CAACc,aAAa,CAAC,CAAC,CAC1C,MAAO,CAAAC,UAAU,CAACc,MAAM,CAACR,KAAK,EAAIA,KAAK,CAACK,IAAI,GAAKA,IAAI,CAAC,CACxD,CAAC,CAEDI,wBAAwB,CAAEA,CAACL,UAAkB,CAAEM,SAAkB,CAAEC,OAAgB,GAAwB,CACzG,KAAM,CAAAjB,UAAU,CAAGf,OAAO,CAACc,aAAa,CAAC,CAAC,CAC1C,MAAO,CAAAC,UAAU,CAACc,MAAM,CAACR,KAAK,EAAI,CAChC,GAAIA,KAAK,CAACI,UAAU,GAAKA,UAAU,CAAE,MAAO,MAAK,CACjD,GAAIM,SAAS,EAAIV,KAAK,CAACK,IAAI,CAAGK,SAAS,CAAE,MAAO,MAAK,CACrD,GAAIC,OAAO,EAAIX,KAAK,CAACK,IAAI,CAAGM,OAAO,CAAE,MAAO,MAAK,CACjD,MAAO,KAAI,CACb,CAAC,CAAC,CACJ,CAAC,CAED;AACAf,sBAAsB,CAAGF,UAA6B,EAAwB,CAC5E,KAAM,CAAAkB,UAAU,CAAG9C,WAAW,CAACC,QAAQ,CAAC,GAAI,CAAA8C,IAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE,CAAEC,YAAY,CAAE,CAAE,CAAC,CAAC,CAC5E,KAAM,CAAAC,UAAU,CAAG/C,MAAM,CAAC4C,UAAU,CAAE,YAAY,CAAC,CAEnD,MAAO,CAAAlB,UAAU,CAACc,MAAM,CAACR,KAAK,EAAIA,KAAK,CAACK,IAAI,EAAIU,UAAU,CAAC,CAC7D,CAAC,CAED;AACAC,SAAS,CAAEA,CAAA,GAAY,CACrBlC,YAAY,CAACmC,UAAU,CAAChD,YAAY,CAACC,SAAS,CAAC,CAC/CY,YAAY,CAACmC,UAAU,CAAChD,YAAY,CAACE,UAAU,CAAC,CAChDW,YAAY,CAACmC,UAAU,CAAChD,YAAY,CAACG,WAAW,CAAC,CACnD,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}